import{c as A,r as m,a as g,o as u,b as c,d as $,e as t,F as M,f as T,n as ie,g as _,t as y,w as Ue,h as l,i as w,j as Ke,k as n,l as Pe,u as rt,m as ct,p as mt,q as vt,s as Te,v as Fe,x as Le}from"./index-DisGbJcK.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ft={class:"meal-slot"},pt={key:0,class:"meals-list"},gt=["onClick"],wt={class:"meal-content"},yt={class:"d-flex align-center gap-1"},bt={class:"meal-name"},kt={key:0,class:"meal-servings"},ht={class:"meal-actions"},_t={__name:"MealSlot",props:{meals:{type:Array,default:()=>[]},date:String,slotId:String,slotName:String,editingMealId:String},emits:["add","edit","delete","cancelEdit"],setup(R,{emit:x}){const E=R,r=x,I=A(()=>E.meals.length>0);return(Z,D)=>{const S=m("v-icon"),b=m("v-btn");return u(),g("div",ft,[c("div",{class:ie(["meal-items-container",{"has-meals":I.value}])},[I.value?(u(),g("div",pt,[(u(!0),g(M,null,T(R.meals,v=>(u(),g("div",{key:v.id,class:ie(["meal-item",{"meal-committed":v.status==="committed","meal-prepared":v.status==="prepared","meal-editing":R.editingMealId===v.id}]),onClick:i=>r("edit",v)},[c("div",wt,[c("div",yt,[c("span",bt,y(v.dishName||"Leer"),1),v.status==="committed"?(u(),_(S,{key:0,icon:"mdi-cart-check",size:"x-small",class:"committed-icon"})):$("",!0),v.status==="prepared"?(u(),_(S,{key:1,icon:"mdi-check-all",size:"x-small",class:"prepared-icon"})):$("",!0)]),v.servings&&v.dishId?(u(),g("span",kt,y(v.servings)+" Portionen ",1)):$("",!0)]),c("div",ht,[R.editingMealId===v.id?(u(),_(b,{key:0,icon:"mdi-close-circle",size:"x-small",variant:"text",density:"compact",class:"cancel-btn",color:"primary",onClick:D[0]||(D[0]=Ue(i=>r("cancelEdit"),["stop"]))})):(u(),_(b,{key:1,icon:"mdi-close",size:"x-small",variant:"text",density:"compact",class:"delete-btn",onClick:Ue(i=>r("delete",v),["stop"])},null,8,["onClick"]))])],10,gt))),128))])):$("",!0),t(b,{variant:"text",size:"small",color:"primary",class:ie(I.value?"add-more-btn":"add-btn"),onClick:D[1]||(D[1]=v=>r("add"))},{default:l(()=>[t(S,{icon:"mdi-plus",size:"small"})]),_:1},8,["class"])],2)])}}},Be=Se(_t,[["__scopeId","data-v-c837acf2"]]),xt={class:"d-flex gap-2 mb-3"},Dt={key:1,class:"text-center py-4"},St={class:"text-h6 mb-1"},zt={class:"text-body-2 text-medium-emphasis mb-4"},Mt={class:"d-flex justify-center gap-2"},Vt={__name:"DishSelector",props:{modelValue:Boolean,dishes:{type:Array,default:()=>[]},initialDish:{type:Object,default:null},initialServings:{type:Number,default:null},showCancel:{type:Boolean,default:!1}},emits:["update:modelValue","select","cancel"],setup(R,{emit:x}){const E=R,r=x,I=w(""),Z=w("all"),D=w(null),S=w(2),b=w(!1),v=w(""),i=A(()=>{const k=new Set;E.dishes.forEach(h=>{h.categories&&Array.isArray(h.categories)&&h.categories.forEach(N=>k.add(N))});const s=Array.from(k).sort();return[{value:"all",title:"Alle"},...s.map(h=>({value:h,title:h}))]}),F=A(()=>{let k=E.dishes;if(Z.value!=="all"&&(k=k.filter(s=>s.categories&&s.categories.includes(Z.value))),I.value){const s=I.value.toLowerCase();k=k.filter(h=>h.name.toLowerCase().includes(s))}return[...k].sort((s,h)=>s.name.localeCompare(h.name))});function G(k){if(k.type==="eating_out"){b.value=!0,v.value="Holschompf";return}D.value=k,S.value=k?.defaultServings||2}function Y(){r("select",{dish:{id:null,type:"eating_out",name:v.value},servings:0}),b.value=!1,v.value="",r("update:modelValue",!1)}function ee(){r("select",{dish:D.value,servings:S.value}),r("update:modelValue",!1)}function L(){D.value=null}function U(){r("update:modelValue",!1)}function q(){r("cancel"),r("update:modelValue",!1)}return Ke(()=>E.modelValue,k=>{k&&(I.value="",Z.value="all",D.value=E.initialDish,S.value=E.initialServings||2,b.value=!1,v.value="")}),(k,s)=>{const h=m("v-spacer"),N=m("v-btn"),J=m("v-card-title"),B=m("v-text-field"),V=m("v-icon"),K=m("v-chip"),te=m("v-chip-group"),ae=m("v-list-item"),ye=m("v-list-item-title"),re=m("v-list"),ce=m("v-card-text"),le=m("v-card"),me=m("v-dialog"),oe=m("v-card-actions");return u(),g(M,null,[t(me,{"model-value":R.modelValue,"onUpdate:modelValue":s[6]||(s[6]=f=>r("update:modelValue",f)),"max-width":"500",scrollable:""},{default:l(()=>[t(le,null,{default:l(()=>[t(J,{class:"d-flex align-center pa-4 pb-2"},{default:l(()=>[s[10]||(s[10]=c("span",null,"Gericht wählen",-1)),t(h),t(N,{icon:"mdi-close",variant:"text",size:"small",onClick:U})]),_:1}),t(ce,{class:"pa-4 pt-0"},{default:l(()=>[D.value?(u(),g("div",Dt,[t(V,{icon:D.value.type==="eating_out"?"mdi-food-takeout-box":"mdi-food",size:"48",color:"primary",class:"mb-3"},null,8,["icon"]),c("div",St,y(D.value.name),1),c("div",zt," Standard: "+y(D.value.defaultServings)+" Portionen ",1),t(B,{modelValue:S.value,"onUpdate:modelValue":s[5]||(s[5]=f=>S.value=f),modelModifiers:{number:!0},label:"Portionen",type:"number",inputmode:"decimal",min:"1",max:"20",style:{"min-width":"200px","max-width":"200px",margin:"0 auto"},"hide-details":"",class:"mb-4 centered-input",autofocus:""},{prepend:l(()=>[t(N,{icon:"mdi-minus",size:"small",variant:"text",disabled:S.value<=1,onClick:s[3]||(s[3]=f=>S.value--)},null,8,["disabled"])]),append:l(()=>[t(N,{icon:"mdi-plus",size:"small",variant:"text",disabled:S.value>=20,onClick:s[4]||(s[4]=f=>S.value++)},null,8,["disabled"])]),_:1},8,["modelValue"]),c("div",Mt,[R.showCancel?$("",!0):(u(),_(N,{key:0,variant:"text",onClick:L},{default:l(()=>[t(V,{start:"",icon:"mdi-arrow-left"}),s[13]||(s[13]=n(" Zurück ",-1))]),_:1})),R.showCancel?(u(),_(N,{key:1,variant:"text",onClick:q},{default:l(()=>[t(V,{start:"",icon:"mdi-close"}),s[14]||(s[14]=n(" Abbrechen ",-1))]),_:1})):$("",!0),t(N,{color:"primary",onClick:ee},{default:l(()=>[t(V,{start:"",icon:"mdi-check"}),s[15]||(s[15]=n(" Hinzufügen ",-1))]),_:1})])])):(u(),g(M,{key:0},[t(B,{modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=f=>I.value=f),"prepend-inner-icon":"mdi-magnify",label:"Suchen...",clearable:"","hide-details":"",class:"mb-3"},null,8,["modelValue"]),c("div",xt,[t(K,{variant:"outlined",color:"accent",onClick:s[1]||(s[1]=f=>G({id:"eating_out",type:"eating_out",name:"Auswärts essen"}))},{default:l(()=>[t(V,{start:"",icon:"mdi-food-takeout-box"}),s[11]||(s[11]=n(" Auswärts ",-1))]),_:1})]),t(te,{modelValue:Z.value,"onUpdate:modelValue":s[2]||(s[2]=f=>Z.value=f),"selected-class":"bg-primary text-white",mandatory:"",class:"mb-3"},{default:l(()=>[(u(!0),g(M,null,T(i.value,f=>(u(),_(K,{key:f.value,value:f.value,variant:"outlined",size:"small"},{default:l(()=>[n(y(f.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(re,{density:"compact",class:"dish-list"},{default:l(()=>[(u(!0),g(M,null,T(F.value,f=>(u(),_(ae,{key:f.id,title:f.name,subtitle:f.categories&&f.categories.length>0?f.categories.join(", "):"Keine Kategorie",onClick:ue=>G(f)},{prepend:l(()=>[t(V,{icon:f.type==="eating_out"?"mdi-food-takeout-box":"mdi-food",color:f.type==="eating_out"?"accent":"primary"},null,8,["icon","color"])]),append:l(()=>[t(V,{icon:"mdi-chevron-right",size:"small"})]),_:2},1032,["title","subtitle","onClick"]))),128)),F.value.length===0?(u(),_(ae,{key:0},{default:l(()=>[t(ye,{class:"text-medium-emphasis text-center"},{default:l(()=>[...s[12]||(s[12]=[n(" Keine Gerichte gefunden ",-1)])]),_:1})]),_:1})):$("",!0)]),_:1})],64))]),_:1})]),_:1})]),_:1},8,["model-value"]),t(me,{modelValue:b.value,"onUpdate:modelValue":s[9]||(s[9]=f=>b.value=f),"max-width":"400"},{default:l(()=>[t(le,null,{default:l(()=>[t(J,null,{default:l(()=>[...s[16]||(s[16]=[n("Auswärts essen",-1)])]),_:1}),t(ce,null,{default:l(()=>[t(B,{modelValue:v.value,"onUpdate:modelValue":s[7]||(s[7]=f=>v.value=f),label:"Beschreibung",autofocus:"",onKeyup:Pe(Y,["enter"])},null,8,["modelValue"])]),_:1}),t(oe,null,{default:l(()=>[t(h),t(N,{variant:"text",onClick:s[8]||(s[8]=f=>b.value=!1)},{default:l(()=>[...s[17]||(s[17]=[n("Abbrechen",-1)])]),_:1}),t(N,{color:"primary",onClick:Y},{default:l(()=>[...s[18]||(s[18]=[n("Hinzufügen",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Ct=Se(Vt,[["__scopeId","data-v-391fbe8a"]]),$t={class:"planer-view"},Nt={class:"d-flex align-center justify-center mb-2"},Et={class:"text-body-2 font-weight-medium"},It={class:"d-flex align-center justify-space-between"},At={class:"d-flex gap-2 align-center"},Ut={key:0,class:"mobile-planer"},Tt={class:"week-divider d-flex align-center my-2"},Ft={class:"text-body-1 font-weight-bold"},Lt={class:"text-body-1 ml-2"},Bt={class:"slot-label-mobile text-caption text-medium-emphasis d-flex align-center",style:{"min-width":"110px","flex-shrink":"0"}},Kt={style:{"white-space":"nowrap"}},Pt={class:"flex-grow-1"},Wt={key:1,class:"desktop-planer"},Ht={class:"week-divider d-flex align-center my-3"},Ot={class:"week-grid-wrapper"},Rt={class:"week-grid"},Zt={class:"day-name"},jt={class:"day-number"},Gt={class:"slot-label"},Yt={style:{"white-space":"nowrap"}},qt={class:"mb-3"},Jt={class:"flex-grow-1"},Qt={class:"d-flex align-center"},Xt={key:0,class:"text-caption text-medium-emphasis ml-8"},el={__name:"PlanerView",setup(R){const x=rt(),E=ct(),r=mt(),I=vt(),Z=new Date;Z.setHours(0,0,0,0);const D=new Date(Z);D.setDate(D.getDate()-3);const S=new Date(Z);S.setDate(S.getDate()+3);const b=w(D),v=w(S),i=w(null),F=w(!1),G=w(!1),Y=w(!1),ee=w(!1),L=w(!1),U=w(!1),q=w(!1),k=w(!1),s=w(""),h=w(!1),N=w(null),J=w(null),B=w(null),V=w(null),K=w(null),te=w(null),ae=w(window.innerWidth),ye=A(()=>ae.value<600),re=A(()=>U.value&&i.value&&!i.value.isNew?i.value.id:null);Te(()=>{window.addEventListener("resize",()=>{ae.value=window.innerWidth}),he(),setTimeout(()=>{ce()},100)});function ce(){const a=document.querySelector(".bg-primary.text-white");if(a){const d=a.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:d-144,behavior:"smooth"})}}const le=[{id:"breakfast",name:"Frühstück",icon:"mdi-coffee"},{id:"lunch",name:"Mittagessen",icon:"mdi-food"},{id:"dinner",name:"Abendessen",icon:"mdi-food-variant"}],me=A(()=>{const a=[],e=new Date(b.value),d=new Date(v.value);for(;e<=d;)a.push({date:ne(e),dayName:We(e),dayNameFull:He(e),dayNumber:e.getDate(),month:e.getMonth()+1,isToday:Oe(e),isPast:Re(e),isMonday:e.getDay()===1,weekNumber:Ze(e)}),e.setDate(e.getDate()+1);return a}),oe=A(()=>{const a=new Map;for(const e of me.value){const d=`${e.date.substring(0,4)}-W${e.weekNumber}`;a.has(d)||a.set(d,{weekNumber:e.weekNumber,days:[]}),a.get(d).days.push(e)}return Array.from(a.values())}),f=A(()=>`${Ve(b.value)} – ${Ve(v.value)}`);A(()=>oe.value.length);const ue=A(()=>x.meals.filter(a=>a.date>=ne(b.value)&&a.date<=ne(v.value)&&a.dishId&&(!a.status||a.status==="planned"))),ze=A(()=>ue.value.length),Me=A(()=>{if(ue.value.length===0)return{from:null,to:null};const a=ue.value.map(e=>e.date).sort();return{from:a[0],to:a[a.length-1]}}),ve=A(()=>!V.value||!K.value?[]:ue.value.filter(a=>a.date>=V.value&&a.date<=K.value));function ne(a){return a.toISOString().split("T")[0]}function Ve(a){const e=new Date(a);return`${e.getDate()}.${e.getMonth()+1}.${e.getFullYear()}`}function We(a){return["So","Mo","Di","Mi","Do","Fr","Sa"][a.getDay()]}function He(a){return["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"][a.getDay()]}function Oe(a){const e=new Date;return a.toDateString()===e.toDateString()}function Re(a){const e=new Date;return e.setHours(0,0,0,0),a<e}function Ze(a){const e=new Date(a);e.setHours(0,0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));const d=new Date(e.getFullYear(),0,1);return Math.ceil(((e-d)/864e5+1)/7)}function je(){const a=new Date(b.value);a.setDate(a.getDate()-7);const e=new Date(v.value);e.setDate(e.getDate()-7),b.value=a,v.value=e}function Ge(){const a=new Date(b.value);a.setDate(a.getDate()+7);const e=new Date(v.value);e.setDate(e.getDate()+7),b.value=a,v.value=e}function Ye(){const a=new Date(b.value);a.setDate(a.getDate()-7),b.value=a}function qe(){const a=new Date(v.value);a.setDate(a.getDate()+7),v.value=a}function Je(){const a=new Date;a.setHours(0,0,0,0);const e=new Date(a);e.setDate(e.getDate()-3);const d=new Date(a);d.setDate(d.getDate()+3),b.value=e,v.value=d}function Ce(a,e){return x.getMealsForDate(a).filter(d=>d.slotId===e)}function $e(a,e,d){i.value={date:a,slotId:e,slotName:d,isNew:!0},G.value=!0}async function Ne(a){if(i.value={...a,isNew:!1},!a.dishId&&a.dishName)q.value=!0;else if(a.status==="committed"||a.status==="prepared"){if(F.value=!1,a.dishId)try{const d=await E.fetchDish(a.dishId);F.value=!!d?.recipeUrl}catch{}L.value=!0}else{if(F.value=!1,a.dishId)try{const d=await E.fetchDish(a.dishId);F.value=!!d?.recipeUrl}catch{}U.value=!0}}function Qe(){U.value=!1,G.value=!0}function Ee(){if(i.value.status==="prepared"){r.showSnackbar("Zubereitete Mahlzeiten können nicht verschoben werden","warning");return}L.value=!1,U.value=!1,N.value=i.value.date,J.value=i.value.slotId,h.value=!0}async function Xe(){try{await x.updateMeal(i.value.id,{date:N.value,slotId:J.value,slotName:le.find(a=>a.id===J.value)?.name}),h.value=!1,r.showSnackbar("Mahlzeit verschoben")}catch{r.showSnackbar("Fehler beim Verschieben der Mahlzeit","error")}}async function Ie(){if(!i.value?.dishId){r.showSnackbar("Kein Rezept verfügbar","warning");return}try{const a=await E.fetchDish(i.value.dishId);a?.recipeUrl?(window.location.href=a.recipeUrl,L.value=!1,U.value=!1):r.showSnackbar("Kein Rezept-Link hinterlegt","warning")}catch{r.showSnackbar("Fehler beim Laden des Rezepts","error")}}async function et({dish:a,servings:e}){try{i.value.isNew?(await x.createMeal({date:i.value.date,slotId:i.value.slotId,slotName:i.value.slotName,dishId:a?.id||null,dishName:a?.type==="eating_out"?a.name:void 0,servings:e||2}),r.showSnackbar("Mahlzeit hinzugefügt")):(await x.updateMeal(i.value.id,{dishId:a?.id||null,dishName:a?.type==="eating_out"?a.name:void 0,servings:e||i.value.servings}),r.showSnackbar("Mahlzeit aktualisiert"))}catch{r.showSnackbar("Fehler beim Speichern der Mahlzeit","error")}G.value=!1}function be(){U.value=!1,i.value=null}function tt(){s.value=i.value.dishName,q.value=!1,k.value=!0}async function Ae(){try{await x.updateMeal(i.value.id,{dishName:s.value}),k.value=!1,s.value="",r.showSnackbar("Beschreibung aktualisiert")}catch{r.showSnackbar("Fehler beim Speichern der Beschreibung","error")}}function lt(){q.value=!1,B.value=i.value,ke()}function fe(a){a.status==="committed"||a.status==="prepared"?(B.value=a,ee.value=!0):(B.value=a,ke())}async function at(){try{const a=await Le.markMealPrepared(i.value.id),e=x.meals.findIndex(d=>d.id===i.value.id);e!==-1&&(x.meals[e]=a),L.value=!1,r.showSnackbar("Mahlzeit als zubereitet markiert")}catch{r.showSnackbar("Fehler beim Markieren der Mahlzeit","error")}}async function nt(){try{const a=await Le.resetMealToCommitted(i.value.id),e=x.meals.findIndex(d=>d.id===i.value.id);e!==-1&&(x.meals[e]=a),L.value=!1,r.showSnackbar("Mahlzeit zurückgesetzt")}catch{r.showSnackbar("Fehler beim Zurücksetzen der Mahlzeit","error")}}async function ke(){try{if(!B.value)return;await x.deleteMeal(B.value.id),r.showSnackbar("Mahlzeit gelöscht"),ee.value=!1,B.value=null}catch{r.showSnackbar("Fehler beim Löschen der Mahlzeit","error")}}async function he(){const a=ne(b.value),e=ne(v.value);await Promise.all([x.fetchMeals(a,e),E.fetchDishes()])}function st(){V.value=Me.value.from,K.value=Me.value.to,te.value=ne(new Date),Y.value=!0}async function it(){try{if(!V.value||!K.value){r.showSnackbar("Bitte wähle einen Zeitraum","warning");return}if(!te.value){r.showSnackbar("Bitte wähle ein Einkaufsdatum","warning");return}if(ve.value.length===0){r.showSnackbar("Keine Mahlzeiten im gewählten Zeitraum","warning");return}await I.generateList(V.value,K.value,te.value),I.shoppingList?.mealIds?.length>0&&(await x.commitMeals(I.shoppingList.mealIds),r.showSnackbar(`${I.shoppingList.mealIds.length} Mahlzeiten zur Einkaufsliste hinzugefügt`)),Y.value=!1}catch{r.showSnackbar("Fehler beim Erstellen der Einkaufsliste","error")}}return Ke([b,v],he),Te(()=>{window.addEventListener("resize",()=>{ae.value=window.innerWidth}),he()}),(a,e)=>{const d=m("v-icon"),z=m("v-btn"),P=m("v-card-text"),W=m("v-card"),j=m("v-divider"),_e=m("v-chip"),Q=m("v-card-title"),de=m("v-text-field"),pe=m("v-alert"),se=m("v-spacer"),ge=m("v-card-actions"),we=m("v-dialog"),H=m("v-list-item-title"),O=m("v-list-item"),xe=m("v-list"),De=m("v-bottom-sheet"),X=m("v-list-item-subtitle"),ot=m("v-select"),ut=m("v-badge");return u(),g("div",$t,[t(W,{class:"mb-4 sticky-nav",variant:"flat",color:"surface"},{default:l(()=>[t(P,{class:"pa-3"},{default:l(()=>[c("div",Nt,[c("span",Et,y(f.value),1)]),c("div",It,[t(z,{variant:"text",size:"small",onClick:je},{default:l(()=>[t(d,{start:"",icon:"mdi-chevron-left"}),e[23]||(e[23]=n(" Vorherige ",-1))]),_:1}),c("div",At,[t(z,{variant:"tonal",color:"primary",size:"small",onClick:Je},{default:l(()=>[...e[24]||(e[24]=[n(" Heute ",-1)])]),_:1})]),t(z,{variant:"text",size:"small",onClick:Ge},{default:l(()=>[e[25]||(e[25]=n(" Nächste ",-1)),t(d,{end:"",icon:"mdi-chevron-right"})]),_:1})])]),_:1})]),_:1}),t(W,{class:"mb-4",variant:"flat",color:"surface"},{default:l(()=>[t(P,{class:"pa-2"},{default:l(()=>[t(z,{block:"",variant:"tonal",color:"primary",onClick:Ye},{default:l(()=>[t(d,{start:"",icon:"mdi-chevron-up"}),e[26]||(e[26]=n(" Frühere Tage anzeigen ",-1))]),_:1})]),_:1})]),_:1}),ye.value?(u(),g("div",Ut,[(u(!0),g(M,null,T(oe.value,o=>(u(),g(M,{key:o.weekNumber},[c("div",Tt,[t(j,{class:"flex-grow-1"}),t(_e,{size:"small",variant:"outlined",class:"mx-2",style:{"min-width":"60px"}},{default:l(()=>[n(" KW "+y(o.weekNumber),1)]),_:2},1024),t(j,{class:"flex-grow-1"})]),(u(!0),g(M,null,T(o.days,p=>(u(),_(W,{key:p.date,class:"mb-3",variant:"flat",color:"surface"},{default:l(()=>[t(Q,{class:ie(["d-flex align-center py-2 px-3",{"bg-primary text-white":p.isToday}])},{default:l(()=>[c("span",Ft,y(p.dayNameFull),1),c("span",Lt,y(p.dayNumber)+"."+y(p.month)+".",1),p.isToday?(u(),_(_e,{key:0,size:"x-small",color:"white",variant:"outlined",class:"ml-2"},{default:l(()=>[...e[27]||(e[27]=[n(" Heute ",-1)])]),_:1})):$("",!0)]),_:2},1032,["class"]),t(j),t(P,{class:"pa-2"},{default:l(()=>[(u(),g(M,null,T(le,C=>c("div",{key:`${p.date}-${C.id}`,class:"mobile-meal-row d-flex align-center py-2"},[c("div",Bt,[t(d,{icon:C.icon,size:"small",class:"mr-1"},null,8,["icon"]),c("span",Kt,y(C.name),1)]),c("div",Pt,[t(Be,{meals:Ce(p.date,C.id),date:p.date,"slot-id":C.id,"slot-name":C.name,"editing-meal-id":re.value,onAdd:dt=>$e(p.date,C.id,C.name),onEdit:Ne,onDelete:fe,onCancelEdit:be},null,8,["meals","date","slot-id","slot-name","editing-meal-id","onAdd"])])])),64))]),_:2},1024)]),_:2},1024))),128))],64))),128))])):(u(),g("div",Wt,[(u(!0),g(M,null,T(oe.value,o=>(u(),g(M,{key:o.weekNumber},[c("div",Ht,[t(j,{class:"flex-grow-1"}),t(_e,{size:"small",variant:"tonal",color:"primary",class:"mx-3"},{default:l(()=>[n(" Kalenderwoche "+y(o.weekNumber),1)]),_:2},1024),t(j,{class:"flex-grow-1"})]),c("div",Ot,[c("div",Rt,[e[28]||(e[28]=c("div",{class:"day-header empty-cell"},null,-1)),(u(!0),g(M,null,T(o.days,p=>(u(),g("div",{key:p.date,class:ie(["day-header",{today:p.isToday,past:p.isPast}])},[c("span",Zt,y(p.dayName),1),c("span",jt,y(p.dayNumber)+"."+y(p.month)+".",1)],2))),128)),(u(!0),g(M,null,T(7-o.days.length,p=>(u(),g("div",{key:"empty-header-"+p,class:"day-header empty-day"}))),128)),(u(),g(M,null,T(le,p=>(u(),g(M,{key:p.id},[c("div",Gt,[t(d,{icon:p.icon,size:"small",class:"mr-1",style:{"flex-shrink":"0"}},null,8,["icon"]),c("span",Yt,y(p.name),1)]),(u(!0),g(M,null,T(o.days,C=>(u(),g("div",{key:`${C.date}-${p.id}`,class:ie(["meal-cell",{past:C.isPast}])},[t(Be,{meals:Ce(C.date,p.id),date:C.date,"slot-id":p.id,"slot-name":p.name,"editing-meal-id":re.value,onAdd:dt=>$e(C.date,p.id,p.name),onEdit:Ne,onDelete:fe,onCancelEdit:be},null,8,["meals","date","slot-id","slot-name","editing-meal-id","onAdd"])],2))),128)),(u(!0),g(M,null,T(7-o.days.length,C=>(u(),g("div",{key:"empty-cell-"+p.id+"-"+C,class:"meal-cell empty-day"}))),128))],64))),64))])])],64))),128))])),t(W,{class:"mt-4",variant:"flat",color:"surface"},{default:l(()=>[t(P,{class:"pa-2"},{default:l(()=>[t(z,{block:"",variant:"tonal",color:"primary",onClick:qe},{default:l(()=>[t(d,{start:"",icon:"mdi-chevron-down"}),e[29]||(e[29]=n(" Spätere Tage anzeigen ",-1))]),_:1})]),_:1})]),_:1}),t(Ct,{modelValue:G.value,"onUpdate:modelValue":e[0]||(e[0]=o=>G.value=o),dishes:Fe(E).dishes,"initial-dish":i.value?.dishId?Fe(E).dishes.find(o=>o.id===i.value.dishId):null,"initial-servings":i.value?.servings,"show-cancel":!i.value?.isNew,onSelect:et,onCancel:be},null,8,["modelValue","dishes","initial-dish","initial-servings","show-cancel"]),t(we,{modelValue:Y.value,"onUpdate:modelValue":e[5]||(e[5]=o=>Y.value=o),"max-width":"500"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,null,{default:l(()=>[...e[30]||(e[30]=[n("Einkaufsliste erstellen",-1)])]),_:1}),t(P,null,{default:l(()=>[e[34]||(e[34]=c("p",{class:"mb-3"}," Wähle den Zeitraum für die Einkaufsliste: ",-1)),t(de,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=o=>V.value=o),label:"Von",type:"date",class:"mb-3"},null,8,["modelValue"]),t(de,{modelValue:K.value,"onUpdate:modelValue":e[2]||(e[2]=o=>K.value=o),label:"Bis",type:"date",class:"mb-3"},null,8,["modelValue"]),t(de,{modelValue:te.value,"onUpdate:modelValue":e[3]||(e[3]=o=>te.value=o),label:"Einkaufsdatum",type:"date",class:"mb-3",hint:"Wann möchtest du einkaufen gehen?","persistent-hint":""},null,8,["modelValue"]),ve.value.length>0?(u(),_(pe,{key:0,type:"success",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[c("strong",null,y(ve.value.length)+" Mahlzeit(en)",1),e[31]||(e[31]=n(" werden hinzugefügt ",-1))]),_:1})):V.value&&K.value?(u(),_(pe,{key:1,type:"warning",variant:"tonal",density:"compact",class:"mb-3"},{default:l(()=>[...e[32]||(e[32]=[n(" Keine Mahlzeiten im gewählten Zeitraum ",-1)])]),_:1})):$("",!0),t(pe,{type:"info",variant:"tonal",density:"compact"},{default:l(()=>[...e[33]||(e[33]=[n(' Die ausgewählten Mahlzeiten werden als "zur Einkaufsliste hinzugefügt" markiert. Bereits vorhandene Artikel in der Liste bleiben erhalten. ',-1)])]),_:1})]),_:1}),t(ge,null,{default:l(()=>[t(se),t(z,{variant:"text",onClick:e[4]||(e[4]=o=>Y.value=!1)},{default:l(()=>[...e[35]||(e[35]=[n("Abbrechen",-1)])]),_:1}),t(z,{color:"success",disabled:ve.value.length===0,onClick:it},{default:l(()=>[t(d,{start:"",icon:"mdi-cart-plus"}),e[36]||(e[36]=n(" Hinzufügen ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(we,{modelValue:ee.value,"onUpdate:modelValue":e[7]||(e[7]=o=>ee.value=o),"max-width":"500"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,null,{default:l(()=>[...e[37]||(e[37]=[n("Mahlzeit löschen?",-1)])]),_:1}),t(P,null,{default:l(()=>[c("p",qt,[c("strong",null,y(B.value?.dishName),1),e[38]||(e[38]=n(" wurde bereits zur Einkaufsliste hinzugefügt. ",-1))]),t(pe,{type:"warning",variant:"tonal",density:"compact"},{default:l(()=>[...e[39]||(e[39]=[n(" Die Zutaten bleiben auf der Einkaufsliste, auch wenn du diese Mahlzeit löschst. ",-1)])]),_:1})]),_:1}),t(ge,null,{default:l(()=>[t(se),t(z,{variant:"text",onClick:e[6]||(e[6]=o=>ee.value=!1)},{default:l(()=>[...e[40]||(e[40]=[n("Abbrechen",-1)])]),_:1}),t(z,{color:"error",onClick:ke},{default:l(()=>[...e[41]||(e[41]=[n(" Trotzdem löschen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(De,{modelValue:q.value,"onUpdate:modelValue":e[9]||(e[9]=o=>q.value=o),"max-width":"500"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,{class:"d-flex align-center pa-4"},{default:l(()=>[t(d,{icon:"mdi-food-takeout-box",class:"mr-2"}),n(" "+y(i.value?.dishName||"Auswärts essen")+" ",1),t(se),t(z,{icon:"mdi-close",variant:"text",size:"small",onClick:e[8]||(e[8]=o=>q.value=!1)})]),_:1}),t(P,{class:"pa-2"},{default:l(()=>[t(xe,{density:"compact"},{default:l(()=>[t(O,{onClick:tt,"prepend-icon":"mdi-pencil"},{default:l(()=>[t(H,null,{default:l(()=>[...e[42]||(e[42]=[n("Beschreibung ändern",-1)])]),_:1})]),_:1}),t(j,{class:"my-2"}),t(O,{onClick:lt,"prepend-icon":"mdi-delete",class:"text-error"},{default:l(()=>[t(H,null,{default:l(()=>[...e[43]||(e[43]=[n("Mahlzeit löschen",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(we,{modelValue:k.value,"onUpdate:modelValue":e[12]||(e[12]=o=>k.value=o),"max-width":"400"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,null,{default:l(()=>[...e[44]||(e[44]=[n("Beschreibung ändern",-1)])]),_:1}),t(P,null,{default:l(()=>[t(de,{modelValue:s.value,"onUpdate:modelValue":e[10]||(e[10]=o=>s.value=o),label:"Beschreibung",autofocus:"",onKeyup:Pe(Ae,["enter"])},null,8,["modelValue"])]),_:1}),t(ge,null,{default:l(()=>[t(se),t(z,{variant:"text",onClick:e[11]||(e[11]=o=>k.value=!1)},{default:l(()=>[...e[45]||(e[45]=[n("Abbrechen",-1)])]),_:1}),t(z,{color:"primary",onClick:Ae},{default:l(()=>[...e[46]||(e[46]=[n("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(De,{modelValue:U.value,"onUpdate:modelValue":e[15]||(e[15]=o=>U.value=o),"max-width":"500"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,{class:"d-flex align-center pa-4"},{default:l(()=>[c("div",Jt,[c("div",Qt,[t(d,{icon:i.value?.dishId?"mdi-food":"mdi-silverware-fork-knife",class:"mr-2"},null,8,["icon"]),n(" "+y(i.value?.dishName||"Leer"),1)]),i.value?.servings?(u(),g("div",Xt,y(i.value.servings)+" Portionen ",1)):$("",!0)]),t(z,{icon:"mdi-close",variant:"text",size:"small",onClick:e[13]||(e[13]=o=>U.value=!1)})]),_:1}),t(P,{class:"pa-2"},{default:l(()=>[t(xe,{density:"compact"},{default:l(()=>[t(O,{onClick:Ee,"prepend-icon":"mdi-arrow-all"},{default:l(()=>[t(H,null,{default:l(()=>[...e[47]||(e[47]=[n("Mahlzeit verschieben",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[48]||(e[48]=[n("Datum oder Slot ändern",-1)])]),_:1})]),_:1}),t(O,{onClick:Qe,"prepend-icon":"mdi-pencil"},{default:l(()=>[t(H,null,{default:l(()=>[...e[49]||(e[49]=[n("Mahlzeit bearbeiten",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[50]||(e[50]=[n("Gericht oder Portionen ändern",-1)])]),_:1})]),_:1}),i.value?.dishId?(u(),_(O,{key:0,onClick:Ie,"prepend-icon":"mdi-book-open-variant",disabled:!F.value},{default:l(()=>[t(H,null,{default:l(()=>[...e[51]||(e[51]=[n("Rezept anzeigen",-1)])]),_:1}),t(X,null,{default:l(()=>[n(y(F.value?"Zutaten und Zubereitung":"Kein Rezept-Link hinterlegt"),1)]),_:1})]),_:1},8,["disabled"])):$("",!0),t(j,{class:"my-2"}),t(O,{onClick:e[14]||(e[14]=o=>{fe(i.value),U.value=!1}),"prepend-icon":"mdi-delete",class:"text-error"},{default:l(()=>[t(H,null,{default:l(()=>[...e[52]||(e[52]=[n("Mahlzeit löschen",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(De,{modelValue:L.value,"onUpdate:modelValue":e[18]||(e[18]=o=>L.value=o),"max-width":"500"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,{class:"d-flex align-center pa-4"},{default:l(()=>[t(d,{icon:i.value?.dishId?"mdi-food":"mdi-silverware-fork-knife",class:"mr-2"},null,8,["icon"]),n(" "+y(i.value?.dishName||"Leer")+" ",1),t(se),t(z,{icon:"mdi-close",variant:"text",size:"small",onClick:e[16]||(e[16]=o=>L.value=!1)})]),_:1}),t(P,{class:"pa-2"},{default:l(()=>[t(xe,{density:"compact"},{default:l(()=>[t(O,{onClick:Ee,"prepend-icon":"mdi-arrow-all"},{default:l(()=>[t(H,null,{default:l(()=>[...e[53]||(e[53]=[n("Mahlzeit verschieben",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[54]||(e[54]=[n("Datum oder Slot ändern",-1)])]),_:1})]),_:1}),i.value?.dishId?(u(),_(O,{key:0,onClick:Ie,"prepend-icon":"mdi-book-open-variant",disabled:!F.value},{default:l(()=>[t(H,null,{default:l(()=>[...e[55]||(e[55]=[n("Rezept anzeigen",-1)])]),_:1}),t(X,null,{default:l(()=>[n(y(F.value?"Zutaten und Zubereitung":"Kein Rezept-Link hinterlegt"),1)]),_:1})]),_:1},8,["disabled"])):$("",!0),t(j,{class:"my-2"}),i.value?.status==="committed"?(u(),_(O,{key:1,onClick:at,"prepend-icon":"mdi-check-all"},{default:l(()=>[t(H,null,{default:l(()=>[...e[56]||(e[56]=[n("Als zubereitet markieren",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[57]||(e[57]=[n("Mahlzeit wurde gekocht",-1)])]),_:1})]),_:1})):$("",!0),i.value?.status==="prepared"?(u(),_(O,{key:2,onClick:nt,"prepend-icon":"mdi-undo-variant"},{default:l(()=>[t(H,null,{default:l(()=>[...e[58]||(e[58]=[n("Zurücksetzen",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[59]||(e[59]=[n("Status auf 'committet' zurücksetzen",-1)])]),_:1})]),_:1})):$("",!0),i.value?.status==="committed"||i.value?.status==="prepared"?(u(),_(j,{key:3,class:"my-2"})):$("",!0),t(O,{onClick:e[17]||(e[17]=o=>{fe(i.value),L.value=!1}),"prepend-icon":"mdi-delete",class:"text-error"},{default:l(()=>[t(H,null,{default:l(()=>[...e[60]||(e[60]=[n("Mahlzeit löschen",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[61]||(e[61]=[n("Aus Einkaufsliste entfernen",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(we,{modelValue:h.value,"onUpdate:modelValue":e[22]||(e[22]=o=>h.value=o),"max-width":"400"},{default:l(()=>[t(W,null,{default:l(()=>[t(Q,null,{default:l(()=>[...e[62]||(e[62]=[n("Mahlzeit verschieben",-1)])]),_:1}),t(P,null,{default:l(()=>[t(de,{modelValue:N.value,"onUpdate:modelValue":e[19]||(e[19]=o=>N.value=o),label:"Datum",type:"date",class:"mb-3"},null,8,["modelValue"]),t(ot,{modelValue:J.value,"onUpdate:modelValue":e[20]||(e[20]=o=>J.value=o),items:le,"item-title":"name","item-value":"id",label:"Slot"},null,8,["modelValue"])]),_:1}),t(ge,null,{default:l(()=>[t(se),t(z,{variant:"text",onClick:e[21]||(e[21]=o=>h.value=!1)},{default:l(()=>[...e[63]||(e[63]=[n("Abbrechen",-1)])]),_:1}),t(z,{color:"primary",onClick:Xe},{default:l(()=>[...e[64]||(e[64]=[n("Verschieben",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),ze.value>0?(u(),_(z,{key:2,color:"success",icon:"mdi-cart-plus",size:"large",position:"fixed",location:"bottom end",class:"mb-16 mr-4",elevation:"4",onClick:st},{default:l(()=>[t(ut,{content:ze.value,color:"error",overlap:"","offset-x":"-12","offset-y":"-12"},{default:l(()=>[t(d,null,{default:l(()=>[...e[65]||(e[65]=[n("mdi-cart-plus",-1)])]),_:1})]),_:1},8,["content"])]),_:1})):$("",!0)])}}},al=Se(el,[["__scopeId","data-v-75eebf88"]]);export{al as default};
