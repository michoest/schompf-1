import{z as He,D as ct,p as $e,i as y,c as z,a as V,o as d,e as t,h as l,r,d as J,k as s,b as c,t as v,B as je,C as Te,F as q,m as Re,f as ee,g as C,y as vt,j as Oe,s as pt,E as ft,w as pe,v as gt}from"./index-BfM3l6ef.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";const bt={class:"mb-4"},_t={key:0},kt={class:"text-body-2"},ht={class:"text-caption text-medium-emphasis"},yt={key:1,class:"text-medium-emphasis"},wt={class:"text-center pa-4"},xt={class:"text-medium-emphasis"},Vt={key:0,class:"floating-action-bar-container"},Ct={class:"d-flex align-center justify-space-between pa-3"},St={class:"d-flex align-center gap-2"},Ut={__name:"ProductBulkEditor",props:{modelValue:Boolean},emits:["update:modelValue"],setup(ye,{emit:H}){const h=He(),I=ct(),g=$e(),A=H,S=y(""),D=y([]),B=y(!1),U=y({categoryId:null,unit:null,expirationDays:null}),ie=z(()=>{const m=[];m.push({value:null,title:"Keine Kategorie",subtitle:"-"});for(const o of I.vendors){const k=I.getCategoriesForVendor(o.id);for(const p of k)m.push({value:p.id,title:p.name,subtitle:o.name,vendorColor:o.color})}return m}),oe=[{title:"Name",key:"name",sortable:!0},{title:"Kategorie",key:"category",sortable:!1},{title:"Einheit",key:"defaultUnit",sortable:!0},{title:"Haltbarkeit (Tage)",key:"freshnessDays",sortable:!0}],j=["Stück","g","kg","ml","l","Packung","Bund","Dose","Glas"],Y=z(()=>{let m=h.products;if(S.value){const o=S.value.toLowerCase();m=m.filter(k=>k.name.toLowerCase().includes(o)||k.categoryName?.toLowerCase().includes(o)||k.vendorName?.toLowerCase().includes(o))}return[...m].sort((o,k)=>o.name.localeCompare(k.name))}),P=z(()=>D.value.length);function te(){if(P.value===0){g.showSnackbar("Bitte wählen Sie mindestens ein Produkt aus","warning");return}U.value={categoryId:null,unit:null,expirationDays:null},B.value=!0}async function le(){try{const m={};if(U.value.categoryId!==null&&U.value.categoryId!==""&&(m.categoryId=U.value.categoryId),U.value.unit!==null&&U.value.unit!==""&&(m.defaultUnit=U.value.unit),U.value.expirationDays!==null&&U.value.expirationDays!==""&&(m.freshnessDays=parseInt(U.value.expirationDays)),Object.keys(m).length===0){g.showSnackbar("Bitte wählen Sie mindestens eine Eigenschaft zum Ändern","warning");return}console.log("Applying bulk updates:",m),console.log("To products:",D.value);const o=[];for(const L of D.value)try{const G=await h.updateProduct(L,m);o.push({productId:L,success:!0,result:G})}catch(G){console.error(`Failed to update product ${L}:`,G),o.push({productId:L,success:!1,error:G})}const k=o.filter(L=>L.success).length,p=o.filter(L=>!L.success).length;console.log("Update results:",{successCount:k,failCount:p,results:o}),p>0?g.showSnackbar(`${k} Produkte aktualisiert, ${p} Fehler`,"warning"):g.showSnackbar(`${k} Produkte aktualisiert`),B.value=!1,D.value=[],await h.fetchProducts()}catch(m){console.error("Bulk update error:",m),g.showSnackbar("Fehler beim Aktualisieren der Produkte","error")}}function Z(m){const o=D.value.indexOf(m);o===-1?D.value.push(m):D.value.splice(o,1)}function N(){D.value=[]}function u(){A("update:modelValue",!1)}return(m,o)=>{const k=r("v-btn"),p=r("v-toolbar-title"),L=r("v-toolbar"),G=r("v-text-field"),O=r("v-data-table"),x=r("v-card-text"),T=r("v-chip"),Q=r("v-icon"),E=r("v-card"),X=r("v-dialog"),re=r("v-card-title"),fe=r("v-avatar"),$=r("v-list-item-subtitle"),ne=r("v-list-item"),ge=r("v-select"),xe=r("v-spacer"),be=r("v-card-actions");return d(),V(q,null,[t(X,{"model-value":ye.modelValue,"onUpdate:modelValue":o[3]||(o[3]=_=>A("update:modelValue",_)),fullscreen:"",transition:"dialog-bottom-transition"},{default:l(()=>[t(E,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(L,{color:"primary"},{default:l(()=>[t(k,{icon:"mdi-close",onClick:u}),t(p,null,{default:l(()=>[...o[9]||(o[9]=[s("Produkte bearbeiten",-1)])]),_:1})]),_:1}),t(x,{class:"pa-4 flex-grow-1 overflow-y-auto"},{default:l(()=>[c("div",bt,[t(G,{modelValue:S.value,"onUpdate:modelValue":o[0]||(o[0]=_=>S.value=_),"prepend-inner-icon":"mdi-magnify",label:"Produkte durchsuchen...","hide-details":"",clearable:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t(O,{modelValue:D.value,"onUpdate:modelValue":o[1]||(o[1]=_=>D.value=_),headers:oe,items:Y.value,"item-value":"id","show-select":"","items-per-page":-1,class:"elevation-1","select-strategy":"all","onClick:row":o[2]||(o[2]=(_,{item:_e})=>Z(_e.id))},{"item.category":l(({item:_})=>[_.categoryName?(d(),V("div",_t,[c("div",kt,v(_.categoryName),1),c("div",ht,v(_.vendorName||"—"),1)])):(d(),V("span",yt,"—"))]),"item.defaultUnit":l(({item:_})=>[s(v(_.defaultUnit||"—"),1)]),"item.freshnessDays":l(({item:_})=>[s(v(_.freshnessDays??"—"),1)]),bottom:l(()=>[c("div",wt,[c("span",xt,v(Y.value.length)+" Produkte ",1)])]),_:1},8,["modelValue","items"])]),_:1}),P.value>0?(d(),V("div",Vt,[t(E,{class:"floating-action-bar",elevation:"8"},{default:l(()=>[c("div",Ct,[c("div",St,[t(T,{color:"primary",variant:"flat",size:"small"},{default:l(()=>[s(v(P.value),1)]),_:1}),o[11]||(o[11]=c("span",{class:"text-body-2"},"ausgewählt",-1)),t(k,{variant:"text",size:"small",onClick:N},{default:l(()=>[...o[10]||(o[10]=[s(" Auswahl aufheben ",-1)])]),_:1})]),t(k,{color:"primary",size:"small",onClick:te},{default:l(()=>[t(Q,{start:"",icon:"mdi-pencil"}),o[12]||(o[12]=s(" Bearbeiten ",-1))]),_:1})])]),_:1})])):J("",!0)]),_:1})]),_:1},8,["model-value"]),t(X,{modelValue:B.value,"onUpdate:modelValue":o[8]||(o[8]=_=>B.value=_),"max-width":"500"},{default:l(()=>[t(E,null,{default:l(()=>[t(re,null,{default:l(()=>[s(v(P.value)+" Produkte bearbeiten",1)]),_:1}),t(x,null,{default:l(()=>[o[13]||(o[13]=c("p",{class:"text-medium-emphasis mb-4"}," Wählen Sie die Eigenschaften aus, die Sie für alle ausgewählten Produkte ändern möchten. Nicht ausgefüllte Felder bleiben unverändert. ",-1)),t(ge,{modelValue:U.value.categoryId,"onUpdate:modelValue":o[4]||(o[4]=_=>U.value.categoryId=_),items:ie.value,"item-title":"title","item-value":"value",label:"Kategorie",clearable:"",class:"mb-3"},{item:l(({item:_,props:_e})=>[t(ne,je(Te(_e)),{prepend:l(()=>[t(fe,{color:_.raw.vendorColor||"#9CA3AF",size:"24",class:"mr-2"},{default:l(()=>[t(Q,{icon:"mdi-store",size:"small",color:"white"})]),_:1},8,["color"])]),default:l(()=>[t($,null,{default:l(()=>[s(v(_.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),selection:l(({item:_})=>[t(T,{color:_.raw.vendorColor||"#9CA3AF",size:"small",label:""},{default:l(()=>[s(v(_.raw.title)+" ("+v(_.raw.subtitle)+") ",1)]),_:2},1032,["color"])]),_:1},8,["modelValue","items"]),t(ge,{modelValue:U.value.unit,"onUpdate:modelValue":o[5]||(o[5]=_=>U.value.unit=_),items:j,label:"Einheit",clearable:"",class:"mb-3"},null,8,["modelValue"]),t(G,{modelValue:U.value.expirationDays,"onUpdate:modelValue":o[6]||(o[6]=_=>U.value.expirationDays=_),modelModifiers:{number:!0},label:"Haltbarkeit (Tage)",type:"number",inputmode:"numeric",min:"0",clearable:"",hint:"Anzahl der Tage, die das Produkt nach dem Kauf haltbar ist","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(be,null,{default:l(()=>[t(xe),t(k,{variant:"text",onClick:o[7]||(o[7]=_=>B.value=!1)},{default:l(()=>[...o[14]||(o[14]=[s(" Abbrechen ",-1)])]),_:1}),t(k,{color:"primary",onClick:le},{default:l(()=>[...o[15]||(o[15]=[s(" Änderungen übernehmen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Nt=De(Ut,[["__scopeId","data-v-b76b33ee"]]),$t={class:"mb-4"},Dt={key:0,class:"d-flex flex-wrap gap-1"},It={key:1,class:"text-medium-emphasis"},Pt={class:"text-center pa-4"},Ft={class:"text-medium-emphasis"},zt={key:0,class:"floating-action-bar-container"},At={class:"d-flex align-center justify-space-between pa-3"},Bt={class:"d-flex align-center gap-2"},Et={__name:"DishBulkEditor",props:{modelValue:Boolean},emits:["update:modelValue"],setup(ye,{emit:H}){const h=Re(),I=$e(),g=H,A=y(""),S=y([]),D=y(!1),B=y({categories:[]}),U=["Dels","Reis","Leisch","Getarisch","Toffels","Rühtück","Suppe","Lat","Holschompf"],ie=[{title:"Name",key:"name",sortable:!0},{title:"Kategorien",key:"categories",sortable:!1},{title:"Portionen",key:"defaultServings",sortable:!0}],oe=z(()=>{let N=h.dishes.filter(u=>u.type!=="eating_out");if(A.value){const u=A.value.toLowerCase();N=N.filter(m=>m.name.toLowerCase().includes(u)||m.categories?.some(o=>o.toLowerCase().includes(u)))}return[...N].sort((u,m)=>u.name.localeCompare(m.name))}),j=z(()=>S.value.length);function Y(){if(j.value===0){I.showSnackbar("Bitte wählen Sie mindestens ein Gericht aus","warning");return}B.value={categories:[]},D.value=!0}async function P(){try{const N={};if(B.value.categories&&B.value.categories.length>0&&(N.categories=B.value.categories),Object.keys(N).length===0){I.showSnackbar("Bitte wählen Sie mindestens eine Kategorie","warning");return}console.log("Applying bulk updates:",N),console.log("To dishes:",S.value);const u=[];for(const k of S.value)try{const p=await h.updateDish(k,N);u.push({dishId:k,success:!0,result:p})}catch(p){console.error(`Failed to update dish ${k}:`,p),u.push({dishId:k,success:!1,error:p})}const m=u.filter(k=>k.success).length,o=u.filter(k=>!k.success).length;console.log("Update results:",{successCount:m,failCount:o,results:u}),o>0?I.showSnackbar(`${m} Gerichte aktualisiert, ${o} Fehler`,"warning"):I.showSnackbar(`${m} Gerichte aktualisiert`),D.value=!1,S.value=[],await h.fetchDishes()}catch(N){console.error("Bulk update error:",N),I.showSnackbar("Fehler beim Aktualisieren der Gerichte","error")}}function te(N){const u=S.value.indexOf(N);u===-1?S.value.push(N):S.value.splice(u,1)}function le(){S.value=[]}function Z(){g("update:modelValue",!1)}return(N,u)=>{const m=r("v-btn"),o=r("v-toolbar-title"),k=r("v-toolbar"),p=r("v-text-field"),L=r("v-chip"),G=r("v-data-table"),O=r("v-card-text"),x=r("v-icon"),T=r("v-card"),Q=r("v-dialog"),E=r("v-card-title"),X=r("v-select"),re=r("v-spacer"),fe=r("v-card-actions");return d(),V(q,null,[t(Q,{"model-value":ye.modelValue,"onUpdate:modelValue":u[3]||(u[3]=$=>g("update:modelValue",$)),fullscreen:"",transition:"dialog-bottom-transition"},{default:l(()=>[t(T,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(k,{color:"primary"},{default:l(()=>[t(m,{icon:"mdi-close",onClick:Z}),t(o,null,{default:l(()=>[...u[7]||(u[7]=[s("Gerichte bearbeiten",-1)])]),_:1})]),_:1}),t(O,{class:"pa-4 flex-grow-1 overflow-y-auto"},{default:l(()=>[c("div",$t,[t(p,{modelValue:A.value,"onUpdate:modelValue":u[0]||(u[0]=$=>A.value=$),"prepend-inner-icon":"mdi-magnify",label:"Gerichte durchsuchen...","hide-details":"",clearable:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t(G,{modelValue:S.value,"onUpdate:modelValue":u[1]||(u[1]=$=>S.value=$),headers:ie,items:oe.value,"item-value":"id","show-select":"","items-per-page":-1,class:"elevation-1","select-strategy":"all","onClick:row":u[2]||(u[2]=($,{item:ne})=>te(ne.id))},{"item.categories":l(({item:$})=>[$.categories&&$.categories.length>0?(d(),V("div",Dt,[(d(!0),V(q,null,ee($.categories,ne=>(d(),C(L,{key:ne,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[s(v(ne),1)]),_:2},1024))),128))])):(d(),V("span",It,"—"))]),"item.defaultServings":l(({item:$})=>[s(v($.defaultServings||"—"),1)]),bottom:l(()=>[c("div",Pt,[c("span",Ft,v(oe.value.length)+" Gerichte ",1)])]),_:1},8,["modelValue","items"])]),_:1}),j.value>0?(d(),V("div",zt,[t(T,{class:"floating-action-bar",elevation:"8"},{default:l(()=>[c("div",At,[c("div",Bt,[t(L,{color:"primary",variant:"flat",size:"small"},{default:l(()=>[s(v(j.value),1)]),_:1}),u[9]||(u[9]=c("span",{class:"text-body-2"},"ausgewählt",-1)),t(m,{variant:"text",size:"small",onClick:le},{default:l(()=>[...u[8]||(u[8]=[s(" Auswahl aufheben ",-1)])]),_:1})]),t(m,{color:"primary",size:"small",onClick:Y},{default:l(()=>[t(x,{start:"",icon:"mdi-pencil"}),u[10]||(u[10]=s(" Bearbeiten ",-1))]),_:1})])]),_:1})])):J("",!0)]),_:1})]),_:1},8,["model-value"]),t(Q,{modelValue:D.value,"onUpdate:modelValue":u[6]||(u[6]=$=>D.value=$),"max-width":"500"},{default:l(()=>[t(T,null,{default:l(()=>[t(E,null,{default:l(()=>[s(v(j.value)+" Gerichte bearbeiten",1)]),_:1}),t(O,null,{default:l(()=>[u[11]||(u[11]=c("p",{class:"text-medium-emphasis mb-4"}," Wählen Sie die Kategorien aus, die für alle ausgewählten Gerichte gesetzt werden sollen. ",-1)),t(X,{modelValue:B.value.categories,"onUpdate:modelValue":u[4]||(u[4]=$=>B.value.categories=$),items:U,label:"Kategorien",multiple:"",chips:"","closable-chips":"",hint:"Die ausgewählten Kategorien ersetzen die bestehenden Kategorien","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(fe,null,{default:l(()=>[t(re),t(m,{variant:"text",onClick:u[5]||(u[5]=$=>D.value=!1)},{default:l(()=>[...u[12]||(u[12]=[s(" Abbrechen ",-1)])]),_:1}),t(m,{color:"primary",onClick:P},{default:l(()=>[...u[13]||(u[13]=[s(" Änderungen übernehmen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Lt=De(Et,[["__scopeId","data-v-62362e50"]]),Gt={class:"verwaltung-view"},Kt={class:"d-flex justify-end mb-4 gap-2"},Zt={key:0},Ot={class:"vendor-header"},Ht={class:"d-flex align-center gap-2"},jt={class:"text-subtitle-1 font-weight-medium"},Tt={class:"d-flex align-center gap-1"},Rt={class:"d-flex align-center gap-1"},Mt={key:1,class:"text-center pa-4 mb-4"},Wt={class:"d-flex align-center justify-space-between mb-4 flex-wrap gap-2"},Jt={class:"d-flex gap-2"},qt={class:"d-flex flex-wrap align-center ga-2 mb-1"},Qt={class:"text-body-1"},Xt={class:"text-caption text-medium-emphasis"},Yt={class:"d-flex align-center justify-space-between mb-4 flex-wrap gap-2"},el={class:"d-flex gap-2"},tl={class:"d-flex flex-wrap align-center ga-2 mb-1"},ll={class:"text-body-1"},al={class:"text-caption text-medium-emphasis"},nl={class:"mb-4"},ol={class:"text-subtitle-2 mb-3"},il={class:"text-subtitle-1 font-weight-bold mb-2"},rl={key:0},sl={key:1,class:"text-medium-emphasis"},ul={class:"d-flex flex-wrap gap-2"},dl={class:"d-flex align-center justify-space-between mb-3"},ml={class:"text-subtitle-2"},cl={key:0},vl={key:1},pl={__name:"VerwaltungView",setup(ye){const H=He(),h=vt(),I=Re(),g=$e(),A=y(""),S=y("vendors"),D=y(window.innerWidth),B=y(!1),U=y(!1);z(()=>D.value<960);const ie=z(()=>D.value>=640);function oe(){D.value=window.innerWidth}const j=y(!1),Y=y(null),P=y({name:"",color:"#10B981"}),te=y(!1),le=y(null),Z=y({name:"",vendorId:null}),N=y(!1),u=y(null),m=y({name:"",categoryId:null,defaultUnit:"",freshnessDays:7}),o=y(!1),k=y(null),p=y({name:"",recipe:"",recipeUrl:"",defaultServings:2,categories:[],ingredients:[]}),L=["Dels","Reis","Leisch","Getarisch","Toffels","Rühtück","Suppe","Lat","Holschompf"],G=y(!1),O=y(null),x=y({productId:null,productName:"",amount:1,unit:"",optional:!1}),T=y(!1),Q=y(""),E=y(""),X=y(""),re=["g","kg","ml","l","Stück","EL","TL","Bund","Packung","Dose","Paar"],fe=["#10B981","#0EA5E9","#8B5CF6","#F97316","#EF4444","#EC4899","#14B8A6","#6366F1"],$=z(()=>[...h.vendors].sort((n,e)=>n.name.localeCompare(e.name))),ne=z(()=>{let n=H.products;if(A.value&&S.value==="products"){const e=A.value.toLowerCase();n=n.filter(i=>i.name.toLowerCase().includes(e))}return[...n].sort((e,i)=>e.name.localeCompare(i.name))}),ge=z(()=>{let n=I.dishes;if(A.value&&S.value==="dishes"){const e=A.value.toLowerCase();n=n.filter(i=>i.name.toLowerCase().includes(e))}return[...n].sort((e,i)=>e.name.localeCompare(i.name))}),xe=z(()=>h.categories.map(n=>{const e=h.vendors.find(i=>i.id===n.vendorId);return{...n,vendorName:e?.name||"Unbekannt",vendorColor:e?.color||"#9CA3AF",displayName:`${n.name} (${e?.name||"Unbekannt"})`}}).sort((n,e)=>n.name.localeCompare(e.name))),be=z(()=>[...h.vendors].sort((e,i)=>e.name.localeCompare(i.name)).map(e=>{const i=h.getCategoriesForVendor(e.id).sort((b,w)=>(b.order||0)-(w.order||0));return{...e,categories:i}})),_=z(()=>{if(!X.value||X.value.length<2)return[];const n=X.value.toLowerCase(),e=[];for(const i of I.dishes)if(i.type!=="eating_out"&&i.ingredients&&Array.isArray(i.ingredients))for(const b of i.ingredients)(b.productName||"").toLowerCase().includes(n)&&e.push({dishId:i.id,dishName:i.name,ingredientName:b.productName,ingredientAmount:b.amount,ingredientUnit:b.unit,ingredientOptional:b.optional||!1});return e}),_e=z(()=>{const n=new Set;return _.value.forEach(e=>n.add(e.dishId)),Array.from(n)}),Me=z(()=>{const n=new Map;for(const e of _.value){const i=e.ingredientName;n.has(i)||n.set(i,{ingredientName:i,dishes:[]}),n.get(i).dishes.push({id:e.dishId,name:e.dishName,ingredientAmount:e.ingredientAmount,ingredientUnit:e.ingredientUnit,ingredientOptional:e.ingredientOptional})}return Array.from(n.values()).sort((e,i)=>e.ingredientName.localeCompare(i.ingredientName))}),Ie=z(()=>ne.value.map(n=>{const e=h.categories.find(b=>b.id===n.categoryId),i=e?h.vendors.find(b=>b.id===e.vendorId):null;return{...n,categoryName:e?.name||null,vendorName:i?.name||null,vendorColor:i?.color||"#9CA3AF"}})),We=z(()=>H.products.map(n=>{const e=h.categories.find(b=>b.id===n.categoryId),i=e?h.vendors.find(b=>b.id===e.vendorId):null;return{value:n.id,title:n.name,subtitle:i&&e?`${i.name}: ${e.name}`:"Keine Kategorie",product:n}}));Oe(()=>x.value.productId,n=>{if(!n)return;const e=H.products.find(i=>i.id===n);e&&(x.value.productName=e.name,e.defaultUnit&&!x.value.unit&&(x.value.unit=e.defaultUnit))}),Oe(()=>x.value.productName,n=>{if(!n||x.value.productId)return;const e=n.toLowerCase().trim(),i=H.products.find(b=>b.name.toLowerCase()===e);i&&(x.value.productId=i.id)});function Pe(n=null){n?(Y.value=n,P.value={...n}):(Y.value=null,P.value={name:"",color:"#10B981"}),j.value=!0}async function Je(){if(!P.value.name.trim()){g.showSnackbar("Name ist erforderlich","error");return}try{Y.value?(await h.updateVendor(Y.value.id,P.value),g.showSnackbar("Händler aktualisiert")):(await h.createVendor(P.value),g.showSnackbar("Händler erstellt")),j.value=!1}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function qe(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await h.deleteVendor(n.id),g.showSnackbar("Händler gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}function Fe(n=null){n?(le.value=n,Z.value={...n}):(le.value=null,Z.value={name:"",vendorId:null}),te.value=!0}async function Qe(){if(!Z.value.name.trim()||!Z.value.vendorId){g.showSnackbar("Name und Händler sind erforderlich","error");return}try{le.value?(await h.updateCategory(le.value.id,Z.value),g.showSnackbar("Kategorie aktualisiert")):(await h.createCategory(Z.value),g.showSnackbar("Kategorie erstellt")),te.value=!1}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function Xe(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await h.deleteCategory(n.id),g.showSnackbar("Kategorie gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}async function Ye(n,e){const i=h.getCategoriesForVendor(e).sort((f,se)=>(f.order||0)-(se.order||0)),b=i.findIndex(f=>f.id===n.id);if(b<=0)return;const w=i[b-1];try{await h.updateCategory(n.id,{order:w.order}),await h.updateCategory(w.id,{order:n.order}),await h.fetchCategories(),g.showSnackbar("Reihenfolge aktualisiert")}catch{g.showSnackbar("Fehler beim Verschieben","error")}}async function et(n,e){const i=h.getCategoriesForVendor(e).sort((f,se)=>(f.order||0)-(se.order||0)),b=i.findIndex(f=>f.id===n.id);if(b>=i.length-1)return;const w=i[b+1];try{await h.updateCategory(n.id,{order:w.order}),await h.updateCategory(w.id,{order:n.order}),await h.fetchCategories(),g.showSnackbar("Reihenfolge aktualisiert")}catch{g.showSnackbar("Fehler beim Verschieben","error")}}function ze(n=null){n?(u.value=n,m.value={...n}):(u.value=null,m.value={name:"",categoryId:null,defaultUnit:"",freshnessDays:7}),N.value=!0}async function tt(){if(!m.value.name.trim()){g.showSnackbar("Name ist erforderlich","error");return}try{u.value?(await H.updateProduct(u.value.id,m.value),g.showSnackbar("Produkt aktualisiert")):(await H.createProduct(m.value),g.showSnackbar("Produkt erstellt")),N.value=!1}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function lt(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await H.deleteProduct(n.id),g.showSnackbar("Produkt gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}function Ve(n=null){n?(k.value=n,p.value={name:n.name,recipe:n.recipe||"",recipeUrl:n.recipeUrl||"",defaultServings:n.defaultServings,categories:[...n.categories||[]],ingredients:[...n.ingredients||[]]}):(k.value=null,p.value={name:"",recipe:"",recipeUrl:"",defaultServings:2,categories:[],ingredients:[]}),o.value=!0}async function at(){if(!p.value.name.trim()){g.showSnackbar("Name ist erforderlich","error");return}try{const n={name:p.value.name.trim(),recipe:p.value.recipe||null,recipeUrl:p.value.recipeUrl||null,defaultServings:p.value.defaultServings,categories:p.value.categories,ingredients:p.value.ingredients,type:"dish"};k.value?(await I.updateDish(k.value.id,n),g.showSnackbar("Gericht aktualisiert")):(await I.createDish(n),g.showSnackbar("Gericht erstellt")),o.value=!1,await I.fetchDishes()}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function nt(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await I.deleteDish(n.id),g.showSnackbar("Gericht gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}function Ae(n=null){n?(O.value=n,x.value={...n}):(O.value=null,x.value={productId:null,productName:"",amount:1,unit:"",optional:!1}),G.value=!0}function ot(){if(!x.value.productName.trim()){g.showSnackbar("Name ist erforderlich","error");return}let n=parseFloat(x.value.amount),e=x.value.unit;(!n||n===0)&&!e&&(n=null,e=null);const i={id:O.value?.id||crypto.randomUUID(),productId:x.value.productId||null,productName:x.value.productName.trim(),amount:n,unit:e,optional:x.value.optional};if(O.value){const b=p.value.ingredients.findIndex(w=>w.id===O.value.id);b!==-1&&(p.value.ingredients[b]=i)}else p.value.ingredients.push(i);G.value=!1}function it(n){p.value.ingredients=p.value.ingredients.filter(e=>e.id!==n.id)}function rt(){Q.value="",E.value="",T.value=!0}async function st(){E.value="";try{const n=JSON.parse(Q.value);if(!n.name||typeof n.name!="string"){E.value='Fehler: "name" ist erforderlich und muss ein String sein';return}if(!Array.isArray(n.ingredients)){E.value='Fehler: "ingredients" muss ein Array sein';return}for(let i=0;i<n.ingredients.length;i++){const b=n.ingredients[i];if(!b.productName||typeof b.productName!="string"){E.value=`Fehler in Zutat ${i+1}: "productName" ist erforderlich`;return}if(b.amount!==null&&b.amount!==void 0&&typeof b.amount!="number"){E.value=`Fehler in Zutat ${i+1}: "amount" muss eine Zahl oder null sein`;return}}const e={name:n.name,recipeUrl:n.recipeUrl||null,defaultServings:n.defaultServings||2,categories:n.categories||[],ingredients:n.ingredients.map(i=>{let b=i.amount??null,w=i.unit??null;return(b===null||b===0)&&(w===null||w==="")&&(b=null,w=null),{id:crypto.randomUUID(),productId:null,productName:i.productName,amount:b,unit:w,optional:i.optional||!1}}),type:"dish"};await I.createDish(e),g.showSnackbar("Gericht aus JSON erstellt"),T.value=!1,await I.fetchDishes()}catch(n){n instanceof SyntaxError?E.value=`JSON Syntax-Fehler: ${n.message}`:E.value=`Fehler: ${n.message}`}}return pt(()=>{window.addEventListener("resize",oe),H.fetchProducts(),h.fetchVendors(),h.fetchCategories(),I.fetchDishes()}),ft(()=>{window.removeEventListener("resize",oe)}),(n,e)=>{const i=r("v-tab"),b=r("v-tabs"),w=r("v-icon"),f=r("v-btn"),se=r("v-avatar"),Be=r("v-list-item-title"),ue=r("v-list-item"),ke=r("v-list"),Ee=r("v-divider"),R=r("v-card-text"),M=r("v-card"),we=r("v-window-item"),W=r("v-text-field"),Le=r("v-chip"),Ge=r("v-list-item-subtitle"),ut=r("v-window"),de=r("v-card-title"),me=r("v-spacer"),ce=r("v-card-actions"),ve=r("v-dialog"),Ce=r("v-select"),Ke=r("v-combobox"),ae=r("v-col"),Se=r("v-row"),Ze=r("v-textarea"),Ue=r("v-alert"),dt=r("v-autocomplete"),mt=r("v-checkbox");return d(),V("div",Gt,[e[80]||(e[80]=c("h1",{class:"text-h5 font-weight-bold mb-4"},"Verwaltung",-1)),t(b,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),color:"primary",class:"mb-4"},{default:l(()=>[t(i,{value:"vendors"},{default:l(()=>[...e[46]||(e[46]=[s("Kategorien",-1)])]),_:1}),t(i,{value:"products"},{default:l(()=>[...e[47]||(e[47]=[s("Produkte",-1)])]),_:1}),t(i,{value:"dishes"},{default:l(()=>[...e[48]||(e[48]=[s("Gerichte",-1)])]),_:1}),t(i,{value:"ingredients"},{default:l(()=>[...e[49]||(e[49]=[s("Zutaten",-1)])]),_:1})]),_:1},8,["modelValue"]),t(ut,{modelValue:S.value,"onUpdate:modelValue":e[12]||(e[12]=a=>S.value=a)},{default:l(()=>[t(we,{value:"vendors"},{default:l(()=>[c("div",Kt,[t(f,{variant:"tonal",color:"primary",onClick:e[1]||(e[1]=a=>Fe())},{default:l(()=>[t(w,{start:"",icon:"mdi-plus"}),e[50]||(e[50]=s(" Neue Kategorie ",-1))]),_:1}),t(f,{color:"primary",onClick:e[2]||(e[2]=a=>Pe())},{default:l(()=>[t(w,{start:"",icon:"mdi-plus"}),e[51]||(e[51]=s(" Neuer Händler ",-1))]),_:1})]),t(M,{variant:"flat",color:"surface"},{default:l(()=>[be.value.length>0?(d(),V("div",Zt,[(d(!0),V(q,null,ee(be.value,(a,K)=>(d(),V("div",{key:a.id},[c("div",Ot,[c("div",Ht,[t(se,{color:a.color,size:"24"},{default:l(()=>[t(w,{icon:"mdi-store",size:"small",color:"white"})]),_:1},8,["color"]),c("span",jt,v(a.name),1)]),c("div",Tt,[t(f,{icon:"mdi-pencil",variant:"text",size:"x-small",onClick:F=>Pe(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:F=>qe(a)},null,8,["onClick"])])]),a.categories.length>0?(d(),C(ke,{key:0,density:"compact",class:"mb-4"},{default:l(()=>[(d(!0),V(q,null,ee(a.categories,(F,Ne)=>(d(),C(ue,{key:F.id,onClick:he=>Fe(F),class:"category-item"},{prepend:l(()=>[t(w,{icon:"mdi-tag",size:"small",color:"primary",class:"ml-4"})]),append:l(()=>[c("div",Rt,[t(f,{icon:"mdi-arrow-up",variant:"text",size:"x-small",disabled:Ne===0,onClick:pe(he=>Ye(F,a.id),["stop"])},null,8,["disabled","onClick"]),t(f,{icon:"mdi-arrow-down",variant:"text",size:"x-small",disabled:Ne===a.categories.length-1,onClick:pe(he=>et(F,a.id),["stop"])},null,8,["disabled","onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:pe(he=>Xe(F),["stop"])},null,8,["onClick"])])]),default:l(()=>[t(Be,null,{default:l(()=>[s(v(F.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)):(d(),V("div",Mt,[...e[52]||(e[52]=[c("span",{class:"text-caption text-medium-emphasis"},"Keine Kategorien",-1)])])),K<be.value.length-1?(d(),C(Ee,{key:2,class:"my-2"})):J("",!0)]))),128))])):(d(),C(R,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[53]||(e[53]=[c("div",{class:"text-medium-emphasis"},"Keine Händler vorhanden",-1)])]),_:1}))]),_:1})]),_:1}),t(we,{value:"products"},{default:l(()=>[c("div",Wt,[t(W,{modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=a=>A.value=a),"prepend-inner-icon":"mdi-magnify",label:"Produkte suchen...",clearable:"","hide-details":"",style:{"max-width":"300px"}},null,8,["modelValue"]),c("div",Jt,[ie.value?(d(),C(f,{key:0,variant:"tonal",color:"primary",onClick:e[4]||(e[4]=a=>B.value=!0)},{default:l(()=>[t(w,{start:"",icon:"mdi-table-edit"}),e[54]||(e[54]=s(" Massenbearbeitung ",-1))]),_:1})):J("",!0),t(f,{color:"primary",onClick:e[5]||(e[5]=a=>ze())},{default:l(()=>[t(w,{start:"",icon:"mdi-plus"}),e[55]||(e[55]=s(" Neues Produkt ",-1))]),_:1})])]),t(M,{variant:"flat",color:"surface"},{default:l(()=>[Ie.value.length>0?(d(),C(ke,{key:0,density:"compact"},{default:l(()=>[(d(!0),V(q,null,ee(Ie.value,a=>(d(),C(ue,{key:a.id,onClick:K=>ze(a)},{default:l(()=>[c("div",qt,[c("span",Qt,v(a.name),1),a.categoryName?(d(),C(Le,{key:0,color:a.vendorColor,size:"x-small",label:""},{default:l(()=>[s(v(a.vendorName)+": "+v(a.categoryName),1)]),_:2},1032,["color"])):J("",!0)]),c("div",Xt,v(a.defaultUnit||"Keine Einheit")+" · "+v(a.freshnessDays)+" Tage haltbar ",1)]),append:l(()=>[t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:pe(K=>lt(a),["stop"])},null,8,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1})):(d(),C(R,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[56]||(e[56]=[c("div",{class:"text-medium-emphasis"},"Keine Produkte gefunden",-1)])]),_:1}))]),_:1})]),_:1}),t(we,{value:"dishes"},{default:l(()=>[c("div",Yt,[t(W,{modelValue:A.value,"onUpdate:modelValue":e[6]||(e[6]=a=>A.value=a),"prepend-inner-icon":"mdi-magnify",label:"Gerichte suchen...",clearable:"","hide-details":"",style:{"max-width":"300px"}},null,8,["modelValue"]),c("div",el,[ie.value?(d(),C(f,{key:0,variant:"tonal",color:"primary",onClick:e[7]||(e[7]=a=>U.value=!0)},{default:l(()=>[t(w,{start:"",icon:"mdi-table-edit"}),e[57]||(e[57]=s(" Massenbearbeitung ",-1))]),_:1})):J("",!0),t(f,{variant:"tonal",color:"primary",onClick:e[8]||(e[8]=a=>rt())},{default:l(()=>[t(w,{start:"",icon:"mdi-code-json"}),e[58]||(e[58]=s(" JSON Import ",-1))]),_:1}),t(f,{color:"primary",onClick:e[9]||(e[9]=a=>Ve())},{default:l(()=>[t(w,{start:"",icon:"mdi-plus"}),e[59]||(e[59]=s(" Neues Gericht ",-1))]),_:1})])]),t(M,{variant:"flat",color:"surface"},{default:l(()=>[ge.value.length>0?(d(),C(ke,{key:0},{default:l(()=>[(d(!0),V(q,null,ee(ge.value,a=>(d(),C(ue,{key:a.id,onClick:K=>Ve(a)},{prepend:l(()=>[t(se,{color:"primary",variant:"tonal"},{default:l(()=>[t(w,{icon:a.type==="eating_out"?"mdi-food-takeout-box":"mdi-food"},null,8,["icon"])]),_:2},1024)]),default:l(()=>[c("div",tl,[c("span",ll,v(a.name),1),(d(!0),V(q,null,ee(a.categories,K=>(d(),C(Le,{key:K,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[s(v(K),1)]),_:2},1024))),128))]),c("div",al,v(a.defaultServings)+" Portionen · "+v(a.ingredients?.length||0)+" Zutaten ",1)]),append:l(()=>[a.recipeUrl?(d(),C(f,{key:0,icon:"mdi-open-in-new",variant:"text",size:"small",href:a.recipeUrl,target:"_blank",onClick:e[10]||(e[10]=pe(()=>{},["stop"]))},null,8,["href"])):J("",!0),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:pe(K=>nt(a),["stop"])},null,8,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1})):(d(),C(R,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[60]||(e[60]=[c("div",{class:"text-medium-emphasis"},"Keine Gerichte gefunden",-1)])]),_:1}))]),_:1})]),_:1}),t(we,{value:"ingredients"},{default:l(()=>[c("div",nl,[t(W,{modelValue:X.value,"onUpdate:modelValue":e[11]||(e[11]=a=>X.value=a),"prepend-inner-icon":"mdi-magnify",label:"Zutat suchen...",clearable:"","hide-details":"",style:{"max-width":"400px"}},null,8,["modelValue"])]),_.value.length>0?(d(),C(M,{key:0,variant:"flat",color:"surface"},{default:l(()=>[t(R,null,{default:l(()=>[c("div",ol,v(_.value.length)+" Zutat(en) gefunden in "+v(_e.value.length)+" Gericht(en) ",1),(d(!0),V(q,null,ee(Me.value,(a,K)=>(d(),V("div",{key:K,class:"mb-6"},[c("div",il,v(a.ingredientName),1),t(ke,{density:"compact"},{default:l(()=>[(d(!0),V(q,null,ee(a.dishes,F=>(d(),C(ue,{key:F.id,onClick:Ne=>Ve(gt(I).dishes.find(he=>he.id===F.id))},{prepend:l(()=>[t(w,{icon:"mdi-food",color:"primary"})]),default:l(()=>[t(Be,null,{default:l(()=>[s(v(F.name),1)]),_:2},1024),t(Ge,null,{default:l(()=>[F.ingredientAmount!==null&&F.ingredientAmount!==0?(d(),V("span",rl,v(F.ingredientAmount)+" "+v(F.ingredientUnit),1)):J("",!0),F.ingredientOptional?(d(),V("span",sl," (optional)")):J("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]))),128))]),_:1})]),_:1})):X.value?(d(),C(M,{key:1,variant:"flat",color:"surface"},{default:l(()=>[t(R,{class:"text-center pa-8"},{default:l(()=>[...e[61]||(e[61]=[c("div",{class:"text-medium-emphasis"}," Keine Gerichte mit dieser Zutat gefunden ",-1)])]),_:1})]),_:1})):(d(),C(M,{key:2,variant:"flat",color:"surface"},{default:l(()=>[t(R,{class:"text-center pa-8"},{default:l(()=>[t(w,{icon:"mdi-information-outline",size:"48",class:"mb-3 text-medium-emphasis"}),e[62]||(e[62]=c("div",{class:"text-medium-emphasis"}," Geben Sie eine Zutat ein, um alle Gerichte zu finden, die diese Zutat verwenden ",-1))]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:j.value,"onUpdate:modelValue":e[15]||(e[15]=a=>j.value=a),"max-width":"400"},{default:l(()=>[t(M,null,{default:l(()=>[t(de,null,{default:l(()=>[s(v(Y.value?"Händler bearbeiten":"Neuer Händler"),1)]),_:1}),t(R,null,{default:l(()=>[t(W,{modelValue:P.value.name,"onUpdate:modelValue":e[13]||(e[13]=a=>P.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),e[63]||(e[63]=c("div",{class:"text-subtitle-2 mb-2"},"Farbe",-1)),c("div",ul,[(d(),V(q,null,ee(fe,a=>t(f,{key:a,color:a,variant:P.value.color===a?"flat":"outlined",icon:"",size:"small",onClick:K=>P.value.color=a},{default:l(()=>[P.value.color===a?(d(),C(w,{key:0,icon:"mdi-check",color:"white"})):J("",!0)]),_:2},1032,["color","variant","onClick"])),64))])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[14]||(e[14]=a=>j.value=!1)},{default:l(()=>[...e[64]||(e[64]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Je},{default:l(()=>[...e[65]||(e[65]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:te.value,"onUpdate:modelValue":e[19]||(e[19]=a=>te.value=a),"max-width":"400"},{default:l(()=>[t(M,null,{default:l(()=>[t(de,null,{default:l(()=>[s(v(le.value?"Kategorie bearbeiten":"Neue Kategorie"),1)]),_:1}),t(R,null,{default:l(()=>[t(W,{modelValue:Z.value.name,"onUpdate:modelValue":e[16]||(e[16]=a=>Z.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),t(Ce,{modelValue:Z.value.vendorId,"onUpdate:modelValue":e[17]||(e[17]=a=>Z.value.vendorId=a),items:$.value,"item-title":"name","item-value":"id",label:"Händler"},null,8,["modelValue","items"])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[18]||(e[18]=a=>te.value=!1)},{default:l(()=>[...e[66]||(e[66]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Qe},{default:l(()=>[...e[67]||(e[67]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:N.value,"onUpdate:modelValue":e[25]||(e[25]=a=>N.value=a),"max-width":"500"},{default:l(()=>[t(M,null,{default:l(()=>[t(de,null,{default:l(()=>[s(v(u.value?"Produkt bearbeiten":"Neues Produkt"),1)]),_:1}),t(R,null,{default:l(()=>[t(W,{modelValue:m.value.name,"onUpdate:modelValue":e[20]||(e[20]=a=>m.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),t(Ce,{modelValue:m.value.categoryId,"onUpdate:modelValue":e[21]||(e[21]=a=>m.value.categoryId=a),items:xe.value,"item-title":"displayName","item-value":"id",label:"Kategorie",clearable:"",class:"mb-3"},null,8,["modelValue","items"]),t(Se,null,{default:l(()=>[t(ae,{cols:"6"},{default:l(()=>[t(Ke,{modelValue:m.value.defaultUnit,"onUpdate:modelValue":e[22]||(e[22]=a=>m.value.defaultUnit=a),items:re,label:"Standard-Einheit"},null,8,["modelValue"])]),_:1}),t(ae,{cols:"6"},{default:l(()=>[t(W,{modelValue:m.value.freshnessDays,"onUpdate:modelValue":e[23]||(e[23]=a=>m.value.freshnessDays=a),modelModifiers:{number:!0},label:"Haltbarkeit (Tage)",type:"number",inputmode:"numeric",min:"1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[24]||(e[24]=a=>N.value=!1)},{default:l(()=>[...e[68]||(e[68]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:tt},{default:l(()=>[...e[69]||(e[69]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:o.value,"onUpdate:modelValue":e[33]||(e[33]=a=>o.value=a),"max-width":"700",scrollable:""},{default:l(()=>[t(M,null,{default:l(()=>[t(de,null,{default:l(()=>[s(v(k.value?"Gericht bearbeiten":"Neues Gericht"),1)]),_:1}),t(R,null,{default:l(()=>[e[72]||(e[72]=c("div",{class:"text-subtitle-2 mb-3"},"Grunddaten",-1)),t(Se,null,{default:l(()=>[t(ae,{cols:"12",md:"6"},{default:l(()=>[t(W,{modelValue:p.value.name,"onUpdate:modelValue":e[26]||(e[26]=a=>p.value.name=a),label:"Name",autofocus:""},null,8,["modelValue"])]),_:1}),t(ae,{cols:"12",md:"6"},{default:l(()=>[t(W,{modelValue:p.value.recipeUrl,"onUpdate:modelValue":e[27]||(e[27]=a=>p.value.recipeUrl=a),label:"Rezept-Link",type:"url","prepend-inner-icon":"mdi-link"},null,8,["modelValue"])]),_:1}),t(ae,{cols:"12",md:"4"},{default:l(()=>[t(W,{modelValue:p.value.defaultServings,"onUpdate:modelValue":e[28]||(e[28]=a=>p.value.defaultServings=a),modelModifiers:{number:!0},label:"Standard-Portionen",type:"number",inputmode:"numeric",min:"1",max:"20"},null,8,["modelValue"])]),_:1}),t(ae,{cols:"12"},{default:l(()=>[t(Ce,{modelValue:p.value.categories,"onUpdate:modelValue":e[29]||(e[29]=a=>p.value.categories=a),items:L,label:"Kategorien",multiple:"",chips:"","closable-chips":"",hint:"Wähle eine oder mehrere Kategorien für dieses Gericht","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(ae,{cols:"12"},{default:l(()=>[t(Ze,{modelValue:p.value.recipe,"onUpdate:modelValue":e[30]||(e[30]=a=>p.value.recipe=a),label:"Rezept / Zubereitungsanleitung",hint:"Hier kannst du die Zubereitung Schritt für Schritt beschreiben","persistent-hint":"",rows:"6","auto-grow":"","prepend-inner-icon":"mdi-book-open-variant"},null,8,["modelValue"])]),_:1})]),_:1}),t(Ee,{class:"my-4"}),c("div",dl,[c("div",ml," Zutaten ("+v(p.value.ingredients.length)+") — pro Portion ",1),t(f,{variant:"tonal",color:"primary",size:"small",onClick:e[31]||(e[31]=a=>Ae())},{default:l(()=>[t(w,{start:"",icon:"mdi-plus"}),e[70]||(e[70]=s(" Zutat hinzufügen ",-1))]),_:1})]),p.value.ingredients.length>0?(d(),C(ke,{key:0,density:"compact"},{default:l(()=>[(d(!0),V(q,null,ee(p.value.ingredients,a=>(d(),C(ue,{key:a.id,title:a.productName},{subtitle:l(()=>[a.amount!==null&&a.amount!==0&&a.unit!==null?(d(),V("span",cl,v(a.amount)+" "+v(a.unit)+v(a.optional?" (optional)":""),1)):a.optional?(d(),V("span",vl,"(optional)")):J("",!0)]),prepend:l(()=>[t(w,{icon:"mdi-circle-small"})]),append:l(()=>[t(f,{icon:"mdi-pencil",variant:"text",size:"small",onClick:K=>Ae(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:K=>it(a)},null,8,["onClick"])]),_:2},1032,["title"]))),128))]),_:1})):(d(),C(Ue,{key:1,type:"info",variant:"tonal",class:"mt-2"},{default:l(()=>[...e[71]||(e[71]=[s(" Noch keine Zutaten hinzugefügt ",-1)])]),_:1}))]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[32]||(e[32]=a=>o.value=!1)},{default:l(()=>[...e[73]||(e[73]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:at},{default:l(()=>[...e[74]||(e[74]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:G.value,"onUpdate:modelValue":e[40]||(e[40]=a=>G.value=a),"max-width":"500"},{default:l(()=>[t(M,null,{default:l(()=>[t(de,null,{default:l(()=>[s(v(O.value?"Zutat bearbeiten":"Zutat hinzufügen"),1)]),_:1}),t(R,null,{default:l(()=>[t(dt,{modelValue:x.value.productId,"onUpdate:modelValue":e[34]||(e[34]=a=>x.value.productId=a),items:We.value,"item-title":"title","item-value":"value",label:"Produkt auswählen (optional)",clearable:"",class:"mb-3"},{item:l(({item:a,props:K})=>[t(ue,je(Te(K)),{default:l(()=>[t(Ge,null,{default:l(()=>[s(v(a.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"]),t(W,{modelValue:x.value.productName,"onUpdate:modelValue":e[35]||(e[35]=a=>x.value.productName=a),label:"Produktname",autofocus:!O.value,class:"mb-3",hint:"Wird automatisch ausgefüllt, wenn ein Produkt ausgewählt wurde"},null,8,["modelValue","autofocus"]),t(Se,null,{default:l(()=>[t(ae,{cols:"6"},{default:l(()=>[t(W,{modelValue:x.value.amount,"onUpdate:modelValue":e[36]||(e[36]=a=>x.value.amount=a),modelModifiers:{number:!0},label:"Menge pro Portion",type:"number",inputmode:"decimal",min:"0",step:"0.1"},null,8,["modelValue"])]),_:1}),t(ae,{cols:"6"},{default:l(()=>[t(Ke,{modelValue:x.value.unit,"onUpdate:modelValue":e[37]||(e[37]=a=>x.value.unit=a),items:re,label:"Einheit"},null,8,["modelValue"])]),_:1})]),_:1}),t(mt,{modelValue:x.value.optional,"onUpdate:modelValue":e[38]||(e[38]=a=>x.value.optional=a),label:"Optional","hide-details":""},null,8,["modelValue"])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[39]||(e[39]=a=>G.value=!1)},{default:l(()=>[...e[75]||(e[75]=[s(" Abbrechen ",-1)])]),_:1}),t(f,{color:"primary",onClick:ot},{default:l(()=>[s(v(O.value?"Speichern":"Hinzufügen"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:T.value,"onUpdate:modelValue":e[43]||(e[43]=a=>T.value=a),"max-width":"800",scrollable:""},{default:l(()=>[t(M,null,{default:l(()=>[t(de,null,{default:l(()=>[...e[76]||(e[76]=[s("Gericht aus JSON importieren",-1)])]),_:1}),t(R,null,{default:l(()=>[t(Ue,{type:"info",variant:"tonal",class:"mb-4"},{default:l(()=>[...e[77]||(e[77]=[c("div",{class:"text-subtitle-2 mb-2"},"Erwartetes Format:",-1),c("pre",{class:"text-caption"},`{
  "name": "Gericht Name",
  "recipeUrl": "https://...",
  "defaultServings": 2,
  "ingredients": [
    {
      "productName": "Zutat 1",
      "amount": 200,
      "unit": "g",
      "optional": false
    }
  ]
}`,-1)])]),_:1}),t(Ze,{modelValue:Q.value,"onUpdate:modelValue":e[41]||(e[41]=a=>Q.value=a),label:"JSON eingeben",rows:"15","auto-grow":"",class:"json-input"},null,8,["modelValue"]),E.value?(d(),C(Ue,{key:0,type:"error",variant:"tonal",class:"mt-3"},{default:l(()=>[s(v(E.value),1)]),_:1})):J("",!0)]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[42]||(e[42]=a=>T.value=!1)},{default:l(()=>[...e[78]||(e[78]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:st,disabled:!Q.value.trim()},{default:l(()=>[...e[79]||(e[79]=[s(" Importieren ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Nt,{modelValue:B.value,"onUpdate:modelValue":e[44]||(e[44]=a=>B.value=a)},null,8,["modelValue"]),t(Lt,{modelValue:U.value,"onUpdate:modelValue":e[45]||(e[45]=a=>U.value=a)},null,8,["modelValue"])])}}},bl=De(pl,[["__scopeId","data-v-c02d509d"]]);export{bl as default};
