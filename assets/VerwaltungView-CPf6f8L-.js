import{z as ot,D as wt,q as Be,i as y,c as A,a as S,o as u,e as t,h as l,r,d as Q,k as s,b as c,t as v,B as Ae,C as Ke,F as X,p as it,f as le,g as x,y as Vt,j as at,v as xt,E as Ct,w as pe,n as nt,u as St,l as H}from"./index-BwcLdMlE.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ut={class:"mb-4"},Dt={key:0},$t={class:"text-body-2"},Nt={class:"text-caption text-medium-emphasis"},It={key:1,class:"text-medium-emphasis"},Ft={class:"text-center pa-4"},zt={class:"text-medium-emphasis"},Pt={key:0,class:"floating-action-bar-container"},At={class:"d-flex align-center justify-space-between pa-3"},Kt={class:"d-flex align-center gap-2"},Bt={__name:"ProductBulkEditor",props:{modelValue:Boolean},emits:["update:modelValue"],setup(ye,{emit:Y}){const _=ot(),N=wt(),b=Be(),E=Y,D=y(""),I=y([]),F=y(!1),$=y({categoryId:null,unit:null,expirationDays:null}),fe=A(()=>{const p=[];p.push({value:null,title:"Keine Kategorie",subtitle:"-"});for(const i of N.vendors){const h=N.getCategoriesForVendor(i.id);for(const d of h)p.push({value:d.id,title:d.name,subtitle:i.name,vendorColor:i.color})}return p}),ue=[{title:"Name",key:"name",sortable:!0},{title:"Kategorie",key:"category",sortable:!1},{title:"Einheit",key:"defaultUnit",sortable:!0},{title:"Haltbarkeit (Tage)",key:"freshnessDays",sortable:!0}],j=["Stück","g","kg","ml","l","Packung","Bund","Dose","Glas"],ae=A(()=>{let p=_.products;if(D.value){const i=D.value.toLowerCase();p=p.filter(h=>h.name.toLowerCase().includes(i)||h.categoryName?.toLowerCase().includes(i)||h.vendorName?.toLowerCase().includes(i))}return[...p].sort((i,h)=>i.name.localeCompare(h.name))}),K=A(()=>I.value.length);function ne(){if(K.value===0){b.showSnackbar("Bitte wählen Sie mindestens ein Produkt aus","warning");return}$.value={categoryId:null,unit:null,expirationDays:null},F.value=!0}async function oe(){try{const p={};if($.value.categoryId!==null&&$.value.categoryId!==""&&(p.categoryId=$.value.categoryId),$.value.unit!==null&&$.value.unit!==""&&(p.defaultUnit=$.value.unit),$.value.expirationDays!==null&&$.value.expirationDays!==""&&(p.freshnessDays=parseInt($.value.expirationDays)),Object.keys(p).length===0){b.showSnackbar("Bitte wählen Sie mindestens eine Eigenschaft zum Ändern","warning");return}console.log("Applying bulk updates:",p),console.log("To products:",I.value);const i=[];for(const L of I.value)try{const G=await _.updateProduct(L,p);i.push({productId:L,success:!0,result:G})}catch(G){console.error(`Failed to update product ${L}:`,G),i.push({productId:L,success:!1,error:G})}const h=i.filter(L=>L.success).length,d=i.filter(L=>!L.success).length;console.log("Update results:",{successCount:h,failCount:d,results:i}),d>0?b.showSnackbar(`${h} Produkte aktualisiert, ${d} Fehler`,"warning"):b.showSnackbar(`${h} Produkte aktualisiert`),F.value=!1,I.value=[],await _.fetchProducts()}catch(p){console.error("Bulk update error:",p),b.showSnackbar("Fehler beim Aktualisieren der Produkte","error")}}function O(p){const i=I.value.indexOf(p);i===-1?I.value.push(p):I.value.splice(i,1)}function U(){I.value=[]}function m(){E("update:modelValue",!1)}return(p,i)=>{const h=r("v-btn"),d=r("v-toolbar-title"),L=r("v-toolbar"),G=r("v-text-field"),T=r("v-data-table"),V=r("v-card-text"),M=r("v-chip"),R=r("v-icon"),z=r("v-card"),ee=r("v-dialog"),ie=r("v-card-title"),Z=r("v-avatar"),C=r("v-list-item-subtitle"),se=r("v-list-item"),_e=r("v-select"),Se=r("v-spacer"),Ue=r("v-card-actions");return u(),S(X,null,[t(ee,{"model-value":ye.modelValue,"onUpdate:modelValue":i[3]||(i[3]=w=>E("update:modelValue",w)),fullscreen:"",transition:"dialog-bottom-transition"},{default:l(()=>[t(z,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(L,{color:"primary"},{default:l(()=>[t(h,{icon:"mdi-close",onClick:m}),t(d,null,{default:l(()=>[...i[9]||(i[9]=[s("Produkte bearbeiten",-1)])]),_:1})]),_:1}),t(V,{class:"pa-4 flex-grow-1 overflow-y-auto"},{default:l(()=>[c("div",Ut,[t(G,{modelValue:D.value,"onUpdate:modelValue":i[0]||(i[0]=w=>D.value=w),"prepend-inner-icon":"mdi-magnify",label:"Produkte durchsuchen...","hide-details":"",clearable:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t(T,{modelValue:I.value,"onUpdate:modelValue":i[1]||(i[1]=w=>I.value=w),headers:ue,items:ae.value,"item-value":"id","show-select":"","items-per-page":-1,class:"elevation-1","select-strategy":"all","onClick:row":i[2]||(i[2]=(w,{item:he})=>O(he.id))},{"item.category":l(({item:w})=>[w.categoryName?(u(),S("div",Dt,[c("div",$t,v(w.categoryName),1),c("div",Nt,v(w.vendorName||"—"),1)])):(u(),S("span",It,"—"))]),"item.defaultUnit":l(({item:w})=>[s(v(w.defaultUnit||"—"),1)]),"item.freshnessDays":l(({item:w})=>[s(v(w.freshnessDays??"—"),1)]),bottom:l(()=>[c("div",Ft,[c("span",zt,v(ae.value.length)+" Produkte ",1)])]),_:1},8,["modelValue","items"])]),_:1}),K.value>0?(u(),S("div",Pt,[t(z,{class:"floating-action-bar",elevation:"8"},{default:l(()=>[c("div",At,[c("div",Kt,[t(M,{color:"primary",variant:"flat",size:"small"},{default:l(()=>[s(v(K.value),1)]),_:1}),i[11]||(i[11]=c("span",{class:"text-body-2"},"ausgewählt",-1)),t(h,{variant:"text",size:"small",onClick:U},{default:l(()=>[...i[10]||(i[10]=[s(" Auswahl aufheben ",-1)])]),_:1})]),t(h,{color:"primary",size:"small",onClick:ne},{default:l(()=>[t(R,{start:"",icon:"mdi-pencil"}),i[12]||(i[12]=s(" Bearbeiten ",-1))]),_:1})])]),_:1})])):Q("",!0)]),_:1})]),_:1},8,["model-value"]),t(ee,{modelValue:F.value,"onUpdate:modelValue":i[8]||(i[8]=w=>F.value=w),"max-width":"500"},{default:l(()=>[t(z,null,{default:l(()=>[t(ie,null,{default:l(()=>[s(v(K.value)+" Produkte bearbeiten",1)]),_:1}),t(V,null,{default:l(()=>[i[13]||(i[13]=c("p",{class:"text-medium-emphasis mb-4"}," Wählen Sie die Eigenschaften aus, die Sie für alle ausgewählten Produkte ändern möchten. Nicht ausgefüllte Felder bleiben unverändert. ",-1)),t(_e,{modelValue:$.value.categoryId,"onUpdate:modelValue":i[4]||(i[4]=w=>$.value.categoryId=w),items:fe.value,"item-title":"title","item-value":"value",label:"Kategorie",clearable:"",class:"mb-3"},{item:l(({item:w,props:he})=>[t(se,Ae(Ke(he)),{prepend:l(()=>[t(Z,{color:w.raw.vendorColor||"#9CA3AF",size:"24",class:"mr-2"},{default:l(()=>[t(R,{icon:"mdi-store",size:"small",color:"white"})]),_:1},8,["color"])]),default:l(()=>[t(C,null,{default:l(()=>[s(v(w.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),selection:l(({item:w})=>[t(M,{color:w.raw.vendorColor||"#9CA3AF",size:"small",label:""},{default:l(()=>[s(v(w.raw.title)+" ("+v(w.raw.subtitle)+") ",1)]),_:2},1032,["color"])]),_:1},8,["modelValue","items"]),t(_e,{modelValue:$.value.unit,"onUpdate:modelValue":i[5]||(i[5]=w=>$.value.unit=w),items:j,label:"Einheit",clearable:"",class:"mb-3"},null,8,["modelValue"]),t(G,{modelValue:$.value.expirationDays,"onUpdate:modelValue":i[6]||(i[6]=w=>$.value.expirationDays=w),modelModifiers:{number:!0},label:"Haltbarkeit (Tage)",type:"number",inputmode:"numeric",min:"0",clearable:"",hint:"Anzahl der Tage, die das Produkt nach dem Kauf haltbar ist","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(Ue,null,{default:l(()=>[t(Se),t(h,{variant:"text",onClick:i[7]||(i[7]=w=>F.value=!1)},{default:l(()=>[...i[14]||(i[14]=[s(" Abbrechen ",-1)])]),_:1}),t(h,{color:"primary",onClick:oe},{default:l(()=>[...i[15]||(i[15]=[s(" Änderungen übernehmen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Et=Ee(Bt,[["__scopeId","data-v-b76b33ee"]]),Gt={class:"mb-4"},Lt={key:0,class:"d-flex flex-wrap gap-1"},Ot={key:1,class:"text-medium-emphasis"},Zt={class:"text-center pa-4"},Ht={class:"text-medium-emphasis"},jt={key:0,class:"floating-action-bar-container"},Tt={class:"d-flex align-center justify-space-between pa-3"},Mt={class:"d-flex align-center gap-2"},Rt={__name:"DishBulkEditor",props:{modelValue:Boolean},emits:["update:modelValue"],setup(ye,{emit:Y}){const _=it(),N=Be(),b=Y,E=y(""),D=y([]),I=y(!1),F=y({categories:[],published:null}),$=["Dels","Reis","Leisch","Getarisch","Toffels","Rühtück","Suppe","Lat","Holschompf"],fe=[{title:"Name",key:"name",sortable:!0},{title:"Kategorien",key:"categories",sortable:!1},{title:"Portionen",key:"defaultServings",sortable:!0}],ue=A(()=>{let U=_.dishes.filter(m=>m.type!=="eating_out");if(E.value){const m=E.value.toLowerCase();U=U.filter(p=>p.name.toLowerCase().includes(m)||p.categories?.some(i=>i.toLowerCase().includes(m)))}return[...U].sort((m,p)=>m.name.localeCompare(p.name))}),j=A(()=>D.value.length);function ae(){if(j.value===0){N.showSnackbar("Bitte wählen Sie mindestens ein Gericht aus","warning");return}F.value={categories:[],published:null},I.value=!0}async function K(){try{const U={};if(F.value.categories&&F.value.categories.length>0&&(U.categories=F.value.categories),F.value.published!==null&&(U.published=F.value.published),Object.keys(U).length===0){N.showSnackbar("Bitte wählen Sie mindestens ein Feld zum Aktualisieren","warning");return}console.log("Applying bulk updates:",U),console.log("To dishes:",D.value);const m=[];for(const h of D.value)try{const d=await _.updateDish(h,U);m.push({dishId:h,success:!0,result:d})}catch(d){console.error(`Failed to update dish ${h}:`,d),m.push({dishId:h,success:!1,error:d})}const p=m.filter(h=>h.success).length,i=m.filter(h=>!h.success).length;console.log("Update results:",{successCount:p,failCount:i,results:m}),i>0?N.showSnackbar(`${p} Gerichte aktualisiert, ${i} Fehler`,"warning"):N.showSnackbar(`${p} Gerichte aktualisiert`),I.value=!1,D.value=[],await _.fetchDishes()}catch(U){console.error("Bulk update error:",U),N.showSnackbar("Fehler beim Aktualisieren der Gerichte","error")}}function ne(U){const m=D.value.indexOf(U);m===-1?D.value.push(U):D.value.splice(m,1)}function oe(){D.value=[]}function O(){b("update:modelValue",!1)}return(U,m)=>{const p=r("v-btn"),i=r("v-toolbar-title"),h=r("v-toolbar"),d=r("v-text-field"),L=r("v-chip"),G=r("v-data-table"),T=r("v-card-text"),V=r("v-icon"),M=r("v-card"),R=r("v-dialog"),z=r("v-card-title"),ee=r("v-select"),ie=r("v-spacer"),Z=r("v-card-actions");return u(),S(X,null,[t(R,{"model-value":ye.modelValue,"onUpdate:modelValue":m[3]||(m[3]=C=>b("update:modelValue",C)),fullscreen:"",transition:"dialog-bottom-transition"},{default:l(()=>[t(M,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(h,{color:"primary"},{default:l(()=>[t(p,{icon:"mdi-close",onClick:O}),t(i,null,{default:l(()=>[...m[8]||(m[8]=[s("Gerichte bearbeiten",-1)])]),_:1})]),_:1}),t(T,{class:"pa-4 flex-grow-1 overflow-y-auto"},{default:l(()=>[c("div",Gt,[t(d,{modelValue:E.value,"onUpdate:modelValue":m[0]||(m[0]=C=>E.value=C),"prepend-inner-icon":"mdi-magnify",label:"Gerichte durchsuchen...","hide-details":"",clearable:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t(G,{modelValue:D.value,"onUpdate:modelValue":m[1]||(m[1]=C=>D.value=C),headers:fe,items:ue.value,"item-value":"id","show-select":"","items-per-page":-1,class:"elevation-1","select-strategy":"all","onClick:row":m[2]||(m[2]=(C,{item:se})=>ne(se.id))},{"item.categories":l(({item:C})=>[C.categories&&C.categories.length>0?(u(),S("div",Lt,[(u(!0),S(X,null,le(C.categories,se=>(u(),x(L,{key:se,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[s(v(se),1)]),_:2},1024))),128))])):(u(),S("span",Ot,"—"))]),"item.defaultServings":l(({item:C})=>[s(v(C.defaultServings||"—"),1)]),bottom:l(()=>[c("div",Zt,[c("span",Ht,v(ue.value.length)+" Gerichte ",1)])]),_:1},8,["modelValue","items"])]),_:1}),j.value>0?(u(),S("div",jt,[t(M,{class:"floating-action-bar",elevation:"8"},{default:l(()=>[c("div",Tt,[c("div",Mt,[t(L,{color:"primary",variant:"flat",size:"small"},{default:l(()=>[s(v(j.value),1)]),_:1}),m[10]||(m[10]=c("span",{class:"text-body-2"},"ausgewählt",-1)),t(p,{variant:"text",size:"small",onClick:oe},{default:l(()=>[...m[9]||(m[9]=[s(" Auswahl aufheben ",-1)])]),_:1})]),t(p,{color:"primary",size:"small",onClick:ae},{default:l(()=>[t(V,{start:"",icon:"mdi-pencil"}),m[11]||(m[11]=s(" Bearbeiten ",-1))]),_:1})])]),_:1})])):Q("",!0)]),_:1})]),_:1},8,["model-value"]),t(R,{modelValue:I.value,"onUpdate:modelValue":m[7]||(m[7]=C=>I.value=C),"max-width":"500"},{default:l(()=>[t(M,null,{default:l(()=>[t(z,null,{default:l(()=>[s(v(j.value)+" Gerichte bearbeiten",1)]),_:1}),t(T,null,{default:l(()=>[m[12]||(m[12]=c("p",{class:"text-medium-emphasis mb-4"}," Wählen Sie die Felder aus, die für alle ausgewählten Gerichte aktualisiert werden sollen. ",-1)),t(ee,{modelValue:F.value.categories,"onUpdate:modelValue":m[4]||(m[4]=C=>F.value.categories=C),items:$,label:"Kategorien",multiple:"",chips:"","closable-chips":"",hint:"Die ausgewählten Kategorien ersetzen die bestehenden Kategorien","persistent-hint":"",class:"mb-4"},null,8,["modelValue"]),t(ee,{modelValue:F.value.published,"onUpdate:modelValue":m[5]||(m[5]=C=>F.value.published=C),items:[{title:"Nicht ändern",value:null},{title:"Im Planer anzeigen",value:!0},{title:"Aus Planer ausblenden",value:!1}],label:"Sichtbarkeit im Planer",hint:"Legt fest, ob die Gerichte im Planer zur Auswahl stehen","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(Z,null,{default:l(()=>[t(ie),t(p,{variant:"text",onClick:m[6]||(m[6]=C=>I.value=!1)},{default:l(()=>[...m[13]||(m[13]=[s(" Abbrechen ",-1)])]),_:1}),t(p,{color:"primary",onClick:K},{default:l(()=>[...m[14]||(m[14]=[s(" Änderungen übernehmen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Wt=Ee(Rt,[["__scopeId","data-v-97166af6"]]),Jt={class:"verwaltung-view"},qt={class:"d-flex justify-end mb-4 gap-2"},Qt={key:0},Xt={class:"vendor-header"},Yt={class:"d-flex align-center gap-2"},el={class:"text-subtitle-1 font-weight-medium"},tl={class:"d-flex align-center gap-1"},ll={class:"d-flex align-center gap-1"},al={key:1,class:"text-center pa-4 mb-4"},nl={class:"d-flex align-center justify-space-between mb-4 flex-wrap gap-2"},ol={class:"d-flex gap-2"},il={class:"d-flex flex-wrap align-center ga-2 mb-1"},sl={class:"text-body-1"},rl={class:"text-caption text-medium-emphasis"},ul={class:"d-flex align-center justify-space-between mb-4 flex-wrap gap-2"},dl={class:"d-flex gap-2"},ml={class:"d-flex flex-wrap align-center ga-2 mb-1"},cl={class:"text-caption text-medium-emphasis"},vl={class:"mb-4"},pl={class:"text-subtitle-2 mb-3"},fl={class:"text-subtitle-1 font-weight-bold mb-2"},gl={key:0},bl={key:1,class:"text-medium-emphasis"},hl={class:"d-flex flex-wrap gap-2"},kl={class:"d-flex align-center justify-space-between mb-3"},yl={class:"text-subtitle-2"},_l={key:0},wl={key:1},Vl={class:"d-flex align-center justify-space-between mb-3"},xl={class:"text-subtitle-2"},Cl={__name:"VerwaltungView",setup(ye){const Y=ot(),_=Vt(),N=it(),b=Be(),E=y(""),D=y("vendors"),I=y(window.innerWidth),F=y(!1),$=y(!1);A(()=>I.value<960);const fe=A(()=>I.value>=640);function ue(){I.value=window.innerWidth}const j=y(!1),ae=y(null),K=y({name:"",color:"#10B981"}),ne=y(!1),oe=y(null),O=y({name:"",vendorId:null}),U=y(!1),m=y(null),p=y({name:"",categoryId:null,defaultUnit:"",freshnessDays:7}),i=y(!1),h=y(null),d=y({name:"",recipe:"",recipeUrl:"",defaultServings:2,categories:[],ingredients:[],subDishes:[],published:!1}),L=["Dels","Reis","Leisch","Getarisch","Toffels","Rühtück","Suppe","Lat","Holschompf"],G=y(!1),T=y(null),V=y({productId:null,productName:"",amount:null,unit:null,optional:!1}),M=y(!1),R=y(null),z=y({dishId:null,scalingFactor:1,optional:!1}),ee=y(!1),ie=y(""),Z=y(""),C=y(""),se=["g","kg","ml","l","Stück","EL","TL","Bund","Packung","Dose","Paar"],_e=["#10B981","#0EA5E9","#8B5CF6","#F97316","#EF4444","#EC4899","#14B8A6","#6366F1"],Se=A(()=>[..._.vendors].sort((n,e)=>n.name.localeCompare(e.name))),Ue=A(()=>{let n=Y.products;if(E.value&&D.value==="products"){const e=E.value.toLowerCase();n=n.filter(o=>o.name.toLowerCase().includes(e))}return[...n].sort((e,o)=>e.name.localeCompare(o.name))}),w=A(()=>{let n=N.dishes;if(E.value&&D.value==="dishes"){const e=E.value.toLowerCase();n=n.filter(o=>o.name.toLowerCase().includes(e))}return[...n].sort((e,o)=>e.name.localeCompare(o.name))}),he=A(()=>_.categories.map(n=>{const e=_.vendors.find(o=>o.id===n.vendorId);return{...n,vendorName:e?.name||"Unbekannt",vendorColor:e?.color||"#9CA3AF",displayName:`${n.name} (${e?.name||"Unbekannt"})`}}).sort((n,e)=>n.name.localeCompare(e.name))),De=A(()=>[..._.vendors].sort((e,o)=>e.name.localeCompare(o.name)).map(e=>{const o=_.getCategoriesForVendor(e.id).sort((g,k)=>(g.order||0)-(k.order||0));return{...e,categories:o}})),we=A(()=>{if(!C.value||C.value.length<2)return[];const n=C.value.toLowerCase(),e=[];for(const o of N.dishes)if(o.type!=="eating_out"&&o.ingredients&&Array.isArray(o.ingredients))for(const g of o.ingredients)(g.productName||"").toLowerCase().includes(n)&&e.push({dishId:o.id,dishName:o.name,ingredientName:g.productName,ingredientAmount:g.amount,ingredientUnit:g.unit,ingredientOptional:g.optional||!1});return e}),st=A(()=>{const n=new Set;return we.value.forEach(e=>n.add(e.dishId)),Array.from(n)}),rt=A(()=>{const n=new Map;for(const e of we.value){const o=e.ingredientName;n.has(o)||n.set(o,{ingredientName:o,dishes:[]}),n.get(o).dishes.push({id:e.dishId,name:e.dishName,ingredientAmount:e.ingredientAmount,ingredientUnit:e.ingredientUnit,ingredientOptional:e.ingredientOptional})}return Array.from(n.values()).sort((e,o)=>e.ingredientName.localeCompare(o.ingredientName))}),Ge=A(()=>Ue.value.map(n=>{const e=_.categories.find(g=>g.id===n.categoryId),o=e?_.vendors.find(g=>g.id===e.vendorId):null;return{...n,categoryName:e?.name||null,vendorName:o?.name||null,vendorColor:o?.color||"#9CA3AF"}})),ut=A(()=>Y.products.map(n=>{const e=_.categories.find(g=>g.id===n.categoryId),o=e?_.vendors.find(g=>g.id===e.vendorId):null;return{value:n.id,title:n.name,subtitle:o&&e?`${o.name}: ${e.name}`:"Keine Kategorie",product:n}})),dt=A(()=>N.dishes.filter(n=>n.type==="dish").filter(n=>!h.value||n.id!==h.value.id).map(n=>({value:n.id,title:n.name,subtitle:n.categories&&n.categories.length>0?n.categories.join(", "):"Keine Kategorien"})).sort((n,e)=>n.title.localeCompare(e.title)));function mt(n){return N.dishes.find(o=>o.id===n)?.name||"Unbekanntes Gericht"}at(()=>V.value.productId,n=>{if(!n)return;const e=Y.products.find(o=>o.id===n);e&&(V.value.productName=e.name,e.defaultUnit&&!V.value.unit&&(V.value.unit=e.defaultUnit))}),at(()=>V.value.productName,n=>{if(!n||V.value.productId)return;const e=n.toLowerCase().trim(),o=Y.products.find(g=>g.name.toLowerCase()===e);o&&(V.value.productId=o.id)});function Le(n=null){n?(ae.value=n,K.value={...n}):(ae.value=null,K.value={name:"",color:"#10B981"}),j.value=!0}async function Oe(){if(!K.value.name.trim()){b.showSnackbar("Name ist erforderlich","error");return}try{ae.value?(await _.updateVendor(ae.value.id,K.value),b.showSnackbar("Händler aktualisiert")):(await _.createVendor(K.value),b.showSnackbar("Händler erstellt")),j.value=!1}catch{b.showSnackbar("Fehler beim Speichern","error")}}async function ct(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await _.deleteVendor(n.id),b.showSnackbar("Händler gelöscht")}catch{b.showSnackbar("Fehler beim Löschen","error")}}function Ze(n=null){n?(oe.value=n,O.value={...n}):(oe.value=null,O.value={name:"",vendorId:null}),ne.value=!0}async function He(){if(!O.value.name.trim()||!O.value.vendorId){b.showSnackbar("Name und Händler sind erforderlich","error");return}try{oe.value?(await _.updateCategory(oe.value.id,O.value),b.showSnackbar("Kategorie aktualisiert")):(await _.createCategory(O.value),b.showSnackbar("Kategorie erstellt")),ne.value=!1}catch{b.showSnackbar("Fehler beim Speichern","error")}}async function vt(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await _.deleteCategory(n.id),b.showSnackbar("Kategorie gelöscht")}catch{b.showSnackbar("Fehler beim Löschen","error")}}async function pt(n,e){const o=_.getCategoriesForVendor(e).sort((f,ge)=>(f.order||0)-(ge.order||0)),g=o.findIndex(f=>f.id===n.id);if(g<=0)return;const k=o[g-1];try{await _.updateCategory(n.id,{order:k.order}),await _.updateCategory(k.id,{order:n.order}),await _.fetchCategories(),b.showSnackbar("Reihenfolge aktualisiert")}catch{b.showSnackbar("Fehler beim Verschieben","error")}}async function ft(n,e){const o=_.getCategoriesForVendor(e).sort((f,ge)=>(f.order||0)-(ge.order||0)),g=o.findIndex(f=>f.id===n.id);if(g>=o.length-1)return;const k=o[g+1];try{await _.updateCategory(n.id,{order:k.order}),await _.updateCategory(k.id,{order:n.order}),await _.fetchCategories(),b.showSnackbar("Reihenfolge aktualisiert")}catch{b.showSnackbar("Fehler beim Verschieben","error")}}function je(n=null){n?(m.value=n,p.value={...n}):(m.value=null,p.value={name:"",categoryId:null,defaultUnit:"",freshnessDays:7}),U.value=!0}async function Te(){if(!p.value.name.trim()){b.showSnackbar("Name ist erforderlich","error");return}try{m.value?(await Y.updateProduct(m.value.id,p.value),b.showSnackbar("Produkt aktualisiert")):(await Y.createProduct(p.value),b.showSnackbar("Produkt erstellt")),U.value=!1}catch{b.showSnackbar("Fehler beim Speichern","error")}}async function gt(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await Y.deleteProduct(n.id),b.showSnackbar("Produkt gelöscht")}catch{b.showSnackbar("Fehler beim Löschen","error")}}function $e(n=null){n?(h.value=n,d.value={name:n.name,recipe:n.recipe||"",recipeUrl:n.recipeUrl||"",defaultServings:n.defaultServings,categories:[...n.categories||[]],ingredients:[...n.ingredients||[]],subDishes:[...n.subDishes||[]],published:n.published??!0}):(h.value=null,d.value={name:"",recipe:"",recipeUrl:"",defaultServings:2,categories:[],ingredients:[],subDishes:[],published:!1}),i.value=!0}async function Me(){if(!d.value.name.trim()){b.showSnackbar("Name ist erforderlich","error");return}try{const n={name:d.value.name.trim(),recipe:d.value.recipe||null,recipeUrl:d.value.recipeUrl||null,defaultServings:d.value.defaultServings,categories:d.value.categories,ingredients:d.value.ingredients,subDishes:d.value.subDishes,published:d.value.published,type:"dish"};h.value?(await N.updateDish(h.value.id,n),b.showSnackbar("Gericht aktualisiert")):(await N.createDish(n),b.showSnackbar("Gericht erstellt")),i.value=!1,await N.fetchDishes()}catch{b.showSnackbar("Fehler beim Speichern","error")}}async function bt(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await N.deleteDish(n.id),b.showSnackbar("Gericht gelöscht")}catch{b.showSnackbar("Fehler beim Löschen","error")}}function Re(n=null){n?(T.value=n,V.value={...n}):(T.value=null,V.value={productId:null,productName:"",amount:null,unit:null,optional:!1}),G.value=!0}function We(){if(!V.value.productName.trim()){b.showSnackbar("Name ist erforderlich","error");return}const n=V.value.amount?String(V.value.amount).replace(",","."):"";let e=n?parseFloat(n):null,o=V.value.unit;(!e||e===0)&&!o&&(e=null,o=null);const g={id:T.value?.id||crypto.randomUUID(),productId:V.value.productId||null,productName:V.value.productName.trim(),amount:e,unit:o,optional:V.value.optional};if(T.value){const k=d.value.ingredients.findIndex(f=>f.id===T.value.id);k!==-1&&(d.value.ingredients[k]=g)}else d.value.ingredients.push(g);G.value=!1}function ht(n){d.value.ingredients=d.value.ingredients.filter(e=>e.id!==n.id)}function Je(n=null){n?(R.value=n,z.value={...n}):(R.value=null,z.value={dishId:null,scalingFactor:1,optional:!1}),M.value=!0}function qe(){if(!z.value.dishId){b.showSnackbar("Gericht ist erforderlich","error");return}if(h.value&&z.value.dishId===h.value.id){b.showSnackbar("Ein Gericht kann nicht sich selbst als Untergericht enthalten","error");return}const n=z.value.scalingFactor?String(z.value.scalingFactor).replace(",","."):"1",e=parseFloat(n)||1,o={id:R.value?.id||crypto.randomUUID(),dishId:z.value.dishId,scalingFactor:e,optional:z.value.optional};if(R.value){const g=d.value.subDishes.findIndex(k=>k.id===R.value.id);g!==-1&&(d.value.subDishes[g]=o)}else d.value.subDishes.push(o);M.value=!1}function kt(n){d.value.subDishes=d.value.subDishes.filter(e=>e.id!==n.id)}function yt(){ie.value="",Z.value="",ee.value=!0}async function Qe(){Z.value="";try{const n=JSON.parse(ie.value);if(!n.name||typeof n.name!="string"){Z.value='Fehler: "name" ist erforderlich und muss ein String sein';return}if(!Array.isArray(n.ingredients)){Z.value='Fehler: "ingredients" muss ein Array sein';return}for(let o=0;o<n.ingredients.length;o++){const g=n.ingredients[o];if(!g.productName||typeof g.productName!="string"){Z.value=`Fehler in Zutat ${o+1}: "productName" ist erforderlich`;return}if(g.amount!==null&&g.amount!==void 0&&typeof g.amount!="number"){Z.value=`Fehler in Zutat ${o+1}: "amount" muss eine Zahl oder null sein`;return}}const e={name:n.name,recipeUrl:n.recipeUrl||null,defaultServings:n.defaultServings||2,categories:n.categories||[],ingredients:n.ingredients.map(o=>{let g=o.amount??null,k=o.unit??null;return(g===null||g===0)&&(k===null||k==="")&&(g=null,k=null),{id:crypto.randomUUID(),productId:null,productName:o.productName,amount:g,unit:k,optional:o.optional||!1}}),type:"dish"};await N.createDish(e),b.showSnackbar("Gericht aus JSON erstellt"),ee.value=!1,await N.fetchDishes()}catch(n){n instanceof SyntaxError?Z.value=`JSON Syntax-Fehler: ${n.message}`:Z.value=`Fehler: ${n.message}`}}return xt(()=>{window.addEventListener("resize",ue),Y.fetchProducts(),_.fetchVendors(),_.fetchCategories(),N.fetchDishes()}),Ct(()=>{window.removeEventListener("resize",ue)}),(n,e)=>{const o=r("v-tab"),g=r("v-tabs"),k=r("v-icon"),f=r("v-btn"),ge=r("v-avatar"),Xe=r("v-list-item-title"),re=r("v-list-item"),be=r("v-list"),Ne=r("v-divider"),W=r("v-card-text"),J=r("v-card"),Ve=r("v-window-item"),q=r("v-text-field"),Ye=r("v-chip"),Ie=r("v-list-item-subtitle"),_t=r("v-window"),de=r("v-card-title"),me=r("v-spacer"),ce=r("v-card-actions"),ve=r("v-dialog"),Fe=r("v-select"),et=r("v-combobox"),te=r("v-col"),xe=r("v-row"),tt=r("v-textarea"),ze=r("v-checkbox"),Ce=r("v-alert"),lt=r("v-autocomplete");return u(),S("div",Jt,[e[97]||(e[97]=c("h1",{class:"text-h5 font-weight-bold mb-4"},"Verwaltung",-1)),t(g,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=a=>D.value=a),color:"primary",class:"mb-4"},{default:l(()=>[t(o,{value:"vendors"},{default:l(()=>[...e[60]||(e[60]=[s("Kategorien",-1)])]),_:1}),t(o,{value:"products"},{default:l(()=>[...e[61]||(e[61]=[s("Produkte",-1)])]),_:1}),t(o,{value:"dishes"},{default:l(()=>[...e[62]||(e[62]=[s("Gerichte",-1)])]),_:1}),t(o,{value:"ingredients"},{default:l(()=>[...e[63]||(e[63]=[s("Zutaten",-1)])]),_:1})]),_:1},8,["modelValue"]),t(_t,{modelValue:D.value,"onUpdate:modelValue":e[12]||(e[12]=a=>D.value=a)},{default:l(()=>[t(Ve,{value:"vendors"},{default:l(()=>[c("div",qt,[t(f,{variant:"tonal",color:"primary",onClick:e[1]||(e[1]=a=>Ze())},{default:l(()=>[t(k,{start:"",icon:"mdi-plus"}),e[64]||(e[64]=s(" Neue Kategorie ",-1))]),_:1}),t(f,{color:"primary",onClick:e[2]||(e[2]=a=>Le())},{default:l(()=>[t(k,{start:"",icon:"mdi-plus"}),e[65]||(e[65]=s(" Neuer Händler ",-1))]),_:1})]),t(J,{variant:"flat",color:"surface"},{default:l(()=>[De.value.length>0?(u(),S("div",Qt,[(u(!0),S(X,null,le(De.value,(a,P)=>(u(),S("div",{key:a.id},[c("div",Xt,[c("div",Yt,[t(ge,{color:a.color,size:"24"},{default:l(()=>[t(k,{icon:"mdi-store",size:"small",color:"white"})]),_:1},8,["color"]),c("span",el,v(a.name),1)]),c("div",tl,[t(f,{icon:"mdi-pencil",variant:"text",size:"x-small",onClick:B=>Le(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:B=>ct(a)},null,8,["onClick"])])]),a.categories.length>0?(u(),x(be,{key:0,density:"compact",class:"mb-4"},{default:l(()=>[(u(!0),S(X,null,le(a.categories,(B,Pe)=>(u(),x(re,{key:B.id,onClick:ke=>Ze(B),class:"category-item"},{prepend:l(()=>[t(k,{icon:"mdi-tag",size:"small",color:"primary",class:"ml-4"})]),append:l(()=>[c("div",ll,[t(f,{icon:"mdi-arrow-up",variant:"text",size:"x-small",disabled:Pe===0,onClick:pe(ke=>pt(B,a.id),["stop"])},null,8,["disabled","onClick"]),t(f,{icon:"mdi-arrow-down",variant:"text",size:"x-small",disabled:Pe===a.categories.length-1,onClick:pe(ke=>ft(B,a.id),["stop"])},null,8,["disabled","onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:pe(ke=>vt(B),["stop"])},null,8,["onClick"])])]),default:l(()=>[t(Xe,null,{default:l(()=>[s(v(B.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)):(u(),S("div",al,[...e[66]||(e[66]=[c("span",{class:"text-caption text-medium-emphasis"},"Keine Kategorien",-1)])])),P<De.value.length-1?(u(),x(Ne,{key:2,class:"my-2"})):Q("",!0)]))),128))])):(u(),x(W,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[67]||(e[67]=[c("div",{class:"text-medium-emphasis"},"Keine Händler vorhanden",-1)])]),_:1}))]),_:1})]),_:1}),t(Ve,{value:"products"},{default:l(()=>[c("div",nl,[t(q,{modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=a=>E.value=a),"prepend-inner-icon":"mdi-magnify",label:"Produkte suchen...",clearable:"","hide-details":"",style:{"max-width":"300px"}},null,8,["modelValue"]),c("div",ol,[fe.value?(u(),x(f,{key:0,variant:"tonal",color:"primary",onClick:e[4]||(e[4]=a=>F.value=!0)},{default:l(()=>[t(k,{start:"",icon:"mdi-table-edit"}),e[68]||(e[68]=s(" Massenbearbeitung ",-1))]),_:1})):Q("",!0),t(f,{color:"primary",onClick:e[5]||(e[5]=a=>je())},{default:l(()=>[t(k,{start:"",icon:"mdi-plus"}),e[69]||(e[69]=s(" Neues Produkt ",-1))]),_:1})])]),t(J,{variant:"flat",color:"surface"},{default:l(()=>[Ge.value.length>0?(u(),x(be,{key:0,density:"compact"},{default:l(()=>[(u(!0),S(X,null,le(Ge.value,a=>(u(),x(re,{key:a.id,onClick:P=>je(a)},{default:l(()=>[c("div",il,[c("span",sl,v(a.name),1),a.categoryName?(u(),x(Ye,{key:0,color:a.vendorColor,size:"x-small",label:""},{default:l(()=>[s(v(a.vendorName)+": "+v(a.categoryName),1)]),_:2},1032,["color"])):Q("",!0)]),c("div",rl,v(a.defaultUnit||"Keine Einheit")+" · "+v(a.freshnessDays)+" Tage haltbar ",1)]),append:l(()=>[t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:pe(P=>gt(a),["stop"])},null,8,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1})):(u(),x(W,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[70]||(e[70]=[c("div",{class:"text-medium-emphasis"},"Keine Produkte gefunden",-1)])]),_:1}))]),_:1})]),_:1}),t(Ve,{value:"dishes"},{default:l(()=>[c("div",ul,[t(q,{modelValue:E.value,"onUpdate:modelValue":e[6]||(e[6]=a=>E.value=a),"prepend-inner-icon":"mdi-magnify",label:"Gerichte suchen...",clearable:"","hide-details":"",style:{"max-width":"300px"}},null,8,["modelValue"]),c("div",dl,[fe.value?(u(),x(f,{key:0,variant:"tonal",color:"primary",onClick:e[7]||(e[7]=a=>$.value=!0)},{default:l(()=>[t(k,{start:"",icon:"mdi-table-edit"}),e[71]||(e[71]=s(" Massenbearbeitung ",-1))]),_:1})):Q("",!0),t(f,{variant:"tonal",color:"primary",onClick:e[8]||(e[8]=a=>yt())},{default:l(()=>[t(k,{start:"",icon:"mdi-code-json"}),e[72]||(e[72]=s(" JSON Import ",-1))]),_:1}),t(f,{color:"primary",onClick:e[9]||(e[9]=a=>$e())},{default:l(()=>[t(k,{start:"",icon:"mdi-plus"}),e[73]||(e[73]=s(" Neues Gericht ",-1))]),_:1})])]),t(J,{variant:"flat",color:"surface"},{default:l(()=>[w.value.length>0?(u(),x(be,{key:0},{default:l(()=>[(u(!0),S(X,null,le(w.value,a=>(u(),x(re,{key:a.id,onClick:P=>$e(a)},{prepend:l(()=>[t(ge,{color:"primary",variant:"tonal",class:nt({"opacity-50":!a.published})},{default:l(()=>[t(k,{icon:a.type==="eating_out"?"mdi-food-takeout-box":"mdi-food"},null,8,["icon"])]),_:2},1032,["class"])]),default:l(()=>[c("div",ml,[c("span",{class:nt(["text-body-1",{"text-medium-emphasis":!a.published}])},v(a.name),3),(u(!0),S(X,null,le(a.categories,P=>(u(),x(Ye,{key:P,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[s(v(P),1)]),_:2},1024))),128))]),c("div",cl,v(a.defaultServings)+" Portionen · "+v(a.ingredients?.length||0)+" Zutaten ",1)]),append:l(()=>[a.recipe?(u(),x(k,{key:0,icon:"mdi-book-open-variant",size:"small",class:"mr-2 text-medium-emphasis"})):Q("",!0),a.recipeUrl?(u(),x(f,{key:1,icon:"mdi-link-variant",variant:"text",size:"small",color:"medium-emphasis",href:a.recipeUrl,target:"_blank",onClick:e[10]||(e[10]=pe(()=>{},["stop"]))},null,8,["href"])):Q("",!0),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:pe(P=>bt(a),["stop"])},null,8,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1})):(u(),x(W,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[74]||(e[74]=[c("div",{class:"text-medium-emphasis"},"Keine Gerichte gefunden",-1)])]),_:1}))]),_:1})]),_:1}),t(Ve,{value:"ingredients"},{default:l(()=>[c("div",vl,[t(q,{modelValue:C.value,"onUpdate:modelValue":e[11]||(e[11]=a=>C.value=a),"prepend-inner-icon":"mdi-magnify",label:"Zutat suchen...",clearable:"","hide-details":"",style:{"max-width":"400px"}},null,8,["modelValue"])]),we.value.length>0?(u(),x(J,{key:0,variant:"flat",color:"surface"},{default:l(()=>[t(W,null,{default:l(()=>[c("div",pl,v(we.value.length)+" Zutat(en) gefunden in "+v(st.value.length)+" Gericht(en) ",1),(u(!0),S(X,null,le(rt.value,(a,P)=>(u(),S("div",{key:P,class:"mb-6"},[c("div",fl,v(a.ingredientName),1),t(be,{density:"compact"},{default:l(()=>[(u(!0),S(X,null,le(a.dishes,B=>(u(),x(re,{key:B.id,onClick:Pe=>$e(St(N).dishes.find(ke=>ke.id===B.id))},{prepend:l(()=>[t(k,{icon:"mdi-food",color:"primary"})]),default:l(()=>[t(Xe,null,{default:l(()=>[s(v(B.name),1)]),_:2},1024),t(Ie,null,{default:l(()=>[B.ingredientAmount!==null&&B.ingredientAmount!==0?(u(),S("span",gl,v(B.ingredientAmount)+" "+v(B.ingredientUnit),1)):Q("",!0),B.ingredientOptional?(u(),S("span",bl," (optional)")):Q("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]))),128))]),_:1})]),_:1})):C.value?(u(),x(J,{key:1,variant:"flat",color:"surface"},{default:l(()=>[t(W,{class:"text-center pa-8"},{default:l(()=>[...e[75]||(e[75]=[c("div",{class:"text-medium-emphasis"}," Keine Gerichte mit dieser Zutat gefunden ",-1)])]),_:1})]),_:1})):(u(),x(J,{key:2,variant:"flat",color:"surface"},{default:l(()=>[t(W,{class:"text-center pa-8"},{default:l(()=>[t(k,{icon:"mdi-information-outline",size:"48",class:"mb-3 text-medium-emphasis"}),e[76]||(e[76]=c("div",{class:"text-medium-emphasis"}," Geben Sie eine Zutat ein, um alle Gerichte zu finden, die diese Zutat verwenden ",-1))]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:j.value,"onUpdate:modelValue":e[16]||(e[16]=a=>j.value=a),"max-width":"400"},{default:l(()=>[t(J,{onKeydown:[e[15]||(e[15]=H(a=>j.value=!1,["esc"])),H(Oe,["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[s(v(ae.value?"Händler bearbeiten":"Neuer Händler"),1)]),_:1}),t(W,null,{default:l(()=>[t(q,{modelValue:K.value.name,"onUpdate:modelValue":e[13]||(e[13]=a=>K.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),e[77]||(e[77]=c("div",{class:"text-subtitle-2 mb-2"},"Farbe",-1)),c("div",hl,[(u(),S(X,null,le(_e,a=>t(f,{key:a,color:a,variant:K.value.color===a?"flat":"outlined",icon:"",size:"small",onClick:P=>K.value.color=a},{default:l(()=>[K.value.color===a?(u(),x(k,{key:0,icon:"mdi-check",color:"white"})):Q("",!0)]),_:2},1032,["color","variant","onClick"])),64))])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[14]||(e[14]=a=>j.value=!1)},{default:l(()=>[...e[78]||(e[78]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Oe},{default:l(()=>[...e[79]||(e[79]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:ne.value,"onUpdate:modelValue":e[21]||(e[21]=a=>ne.value=a),"max-width":"400"},{default:l(()=>[t(J,{onKeydown:[e[20]||(e[20]=H(a=>ne.value=!1,["esc"])),H(He,["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[s(v(oe.value?"Kategorie bearbeiten":"Neue Kategorie"),1)]),_:1}),t(W,null,{default:l(()=>[t(q,{modelValue:O.value.name,"onUpdate:modelValue":e[17]||(e[17]=a=>O.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),t(Fe,{modelValue:O.value.vendorId,"onUpdate:modelValue":e[18]||(e[18]=a=>O.value.vendorId=a),items:Se.value,"item-title":"name","item-value":"id",label:"Händler"},null,8,["modelValue","items"])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[19]||(e[19]=a=>ne.value=!1)},{default:l(()=>[...e[80]||(e[80]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:He},{default:l(()=>[...e[81]||(e[81]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:U.value,"onUpdate:modelValue":e[28]||(e[28]=a=>U.value=a),"max-width":"500"},{default:l(()=>[t(J,{onKeydown:[e[27]||(e[27]=H(a=>U.value=!1,["esc"])),H(Te,["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[s(v(m.value?"Produkt bearbeiten":"Neues Produkt"),1)]),_:1}),t(W,null,{default:l(()=>[t(q,{modelValue:p.value.name,"onUpdate:modelValue":e[22]||(e[22]=a=>p.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),t(Fe,{modelValue:p.value.categoryId,"onUpdate:modelValue":e[23]||(e[23]=a=>p.value.categoryId=a),items:he.value,"item-title":"displayName","item-value":"id",label:"Kategorie",clearable:"",class:"mb-3"},null,8,["modelValue","items"]),t(xe,null,{default:l(()=>[t(te,{cols:"6"},{default:l(()=>[t(et,{modelValue:p.value.defaultUnit,"onUpdate:modelValue":e[24]||(e[24]=a=>p.value.defaultUnit=a),items:se,label:"Standard-Einheit"},null,8,["modelValue"])]),_:1}),t(te,{cols:"6"},{default:l(()=>[t(q,{modelValue:p.value.freshnessDays,"onUpdate:modelValue":e[25]||(e[25]=a=>p.value.freshnessDays=a),modelModifiers:{number:!0},label:"Haltbarkeit (Tage)",type:"number",inputmode:"numeric",min:"1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[26]||(e[26]=a=>U.value=!1)},{default:l(()=>[...e[82]||(e[82]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Te},{default:l(()=>[...e[83]||(e[83]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:i.value,"onUpdate:modelValue":e[39]||(e[39]=a=>i.value=a),"max-width":"700",scrollable:""},{default:l(()=>[t(J,{onKeydown:[e[38]||(e[38]=H(a=>i.value=!1,["esc"])),H(Me,["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[s(v(h.value?"Gericht bearbeiten":"Neues Gericht"),1)]),_:1}),t(W,null,{default:l(()=>[e[88]||(e[88]=c("div",{class:"text-subtitle-2 mb-3"},"Grunddaten",-1)),t(xe,null,{default:l(()=>[t(te,{cols:"12",md:"6"},{default:l(()=>[t(q,{modelValue:d.value.name,"onUpdate:modelValue":e[29]||(e[29]=a=>d.value.name=a),label:"Name",autofocus:""},null,8,["modelValue"])]),_:1}),t(te,{cols:"12",md:"6"},{default:l(()=>[t(q,{modelValue:d.value.recipeUrl,"onUpdate:modelValue":e[30]||(e[30]=a=>d.value.recipeUrl=a),label:"Rezept-Link",type:"url","prepend-inner-icon":"mdi-link"},null,8,["modelValue"])]),_:1}),t(te,{cols:"12",md:"4"},{default:l(()=>[t(q,{modelValue:d.value.defaultServings,"onUpdate:modelValue":e[31]||(e[31]=a=>d.value.defaultServings=a),modelModifiers:{number:!0},label:"Standard-Portionen",type:"number",inputmode:"numeric",min:"1",max:"20"},null,8,["modelValue"])]),_:1}),t(te,{cols:"12"},{default:l(()=>[t(Fe,{modelValue:d.value.categories,"onUpdate:modelValue":e[32]||(e[32]=a=>d.value.categories=a),items:L,label:"Kategorien",multiple:"",chips:"","closable-chips":"",hint:"Wähle eine oder mehrere Kategorien für dieses Gericht","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(te,{cols:"12"},{default:l(()=>[t(tt,{modelValue:d.value.recipe,"onUpdate:modelValue":e[33]||(e[33]=a=>d.value.recipe=a),label:"Rezept / Zubereitungsanleitung",hint:"Hier kannst du die Zubereitung Schritt für Schritt beschreiben","persistent-hint":"",rows:"6","auto-grow":"","prepend-inner-icon":"mdi-book-open-variant"},null,8,["modelValue"])]),_:1}),t(te,{cols:"12"},{default:l(()=>[t(ze,{modelValue:d.value.published,"onUpdate:modelValue":e[34]||(e[34]=a=>d.value.published=a),label:"Im Planer anzeigen",hint:"Wenn deaktiviert, wird das Gericht nicht im Planer zur Auswahl angezeigt","persistent-hint":"",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1}),t(Ne,{class:"my-4"}),c("div",kl,[c("div",yl," Zutaten ("+v(d.value.ingredients.length)+") — pro Portion ",1),t(f,{variant:"tonal",color:"primary",size:"small",onClick:e[35]||(e[35]=a=>Re())},{default:l(()=>[t(k,{start:"",icon:"mdi-plus"}),e[84]||(e[84]=s(" Zutat hinzufügen ",-1))]),_:1})]),d.value.ingredients.length>0?(u(),x(be,{key:0,density:"compact"},{default:l(()=>[(u(!0),S(X,null,le(d.value.ingredients,a=>(u(),x(re,{key:a.id,title:a.productName},{subtitle:l(()=>[a.amount!==null&&a.amount!==0&&a.unit!==null?(u(),S("span",_l,v(a.amount)+" "+v(a.unit)+v(a.optional?" (optional)":""),1)):a.optional?(u(),S("span",wl,"(optional)")):Q("",!0)]),prepend:l(()=>[t(k,{icon:"mdi-circle-small"})]),append:l(()=>[t(f,{icon:"mdi-pencil",variant:"text",size:"small",onClick:P=>Re(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:P=>ht(a)},null,8,["onClick"])]),_:2},1032,["title"]))),128))]),_:1})):(u(),x(Ce,{key:1,type:"info",variant:"tonal",class:"mt-2"},{default:l(()=>[...e[85]||(e[85]=[s(" Noch keine Zutaten hinzugefügt ",-1)])]),_:1})),t(Ne,{class:"my-4"}),c("div",Vl,[c("div",xl," Untergerichte ("+v(d.value.subDishes.length)+") ",1),t(f,{variant:"tonal",color:"primary",size:"small",onClick:e[36]||(e[36]=a=>Je())},{default:l(()=>[t(k,{start:"",icon:"mdi-plus"}),e[86]||(e[86]=s(" Untergericht hinzufügen ",-1))]),_:1})]),d.value.subDishes.length>0?(u(),x(be,{key:2,density:"compact"},{default:l(()=>[(u(!0),S(X,null,le(d.value.subDishes,a=>(u(),x(re,{key:a.id,title:mt(a.dishId)},{subtitle:l(()=>[s(" Faktor: "+v(a.scalingFactor)+v(a.optional?" (optional)":""),1)]),prepend:l(()=>[t(k,{icon:"mdi-food"})]),append:l(()=>[t(f,{icon:"mdi-pencil",variant:"text",size:"small",onClick:P=>Je(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:P=>kt(a)},null,8,["onClick"])]),_:2},1032,["title"]))),128))]),_:1})):(u(),x(Ce,{key:3,type:"info",variant:"tonal",class:"mt-2"},{default:l(()=>[...e[87]||(e[87]=[s(" Keine Untergerichte hinzugefügt ",-1)])]),_:1}))]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[37]||(e[37]=a=>i.value=!1)},{default:l(()=>[...e[89]||(e[89]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Me},{default:l(()=>[...e[90]||(e[90]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:G.value,"onUpdate:modelValue":e[47]||(e[47]=a=>G.value=a),"max-width":"500"},{default:l(()=>[t(J,{onKeydown:[e[46]||(e[46]=H(a=>G.value=!1,["esc"])),H(We,["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[s(v(T.value?"Zutat bearbeiten":"Zutat hinzufügen"),1)]),_:1}),t(W,null,{default:l(()=>[t(lt,{modelValue:V.value.productId,"onUpdate:modelValue":e[40]||(e[40]=a=>V.value.productId=a),items:ut.value,"item-title":"title","item-value":"value",label:"Produkt auswählen (optional)",clearable:"",class:"mb-3"},{item:l(({item:a,props:P})=>[t(re,Ae(Ke(P)),{default:l(()=>[t(Ie,null,{default:l(()=>[s(v(a.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"]),t(q,{modelValue:V.value.productName,"onUpdate:modelValue":e[41]||(e[41]=a=>V.value.productName=a),label:"Produktname",autofocus:!T.value,class:"mb-3",hint:"Wird automatisch ausgefüllt, wenn ein Produkt ausgewählt wurde"},null,8,["modelValue","autofocus"]),t(xe,null,{default:l(()=>[t(te,{cols:"6"},{default:l(()=>[t(q,{modelValue:V.value.amount,"onUpdate:modelValue":e[42]||(e[42]=a=>V.value.amount=a),label:"Menge pro Portion",type:"text",inputmode:"decimal"},null,8,["modelValue"])]),_:1}),t(te,{cols:"6"},{default:l(()=>[t(et,{modelValue:V.value.unit,"onUpdate:modelValue":e[43]||(e[43]=a=>V.value.unit=a),items:se,label:"Einheit"},null,8,["modelValue"])]),_:1})]),_:1}),t(ze,{modelValue:V.value.optional,"onUpdate:modelValue":e[44]||(e[44]=a=>V.value.optional=a),label:"Optional","hide-details":""},null,8,["modelValue"])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[45]||(e[45]=a=>G.value=!1)},{default:l(()=>[...e[91]||(e[91]=[s(" Abbrechen ",-1)])]),_:1}),t(f,{color:"primary",onClick:We},{default:l(()=>[s(v(T.value?"Speichern":"Hinzufügen"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:M.value,"onUpdate:modelValue":e[53]||(e[53]=a=>M.value=a),"max-width":"500"},{default:l(()=>[t(J,{onKeydown:[e[52]||(e[52]=H(a=>M.value=!1,["esc"])),H(qe,["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[s(v(R.value?"Untergericht bearbeiten":"Untergericht hinzufügen"),1)]),_:1}),t(W,null,{default:l(()=>[t(lt,{modelValue:z.value.dishId,"onUpdate:modelValue":e[48]||(e[48]=a=>z.value.dishId=a),items:dt.value,"item-title":"title","item-value":"value",label:"Gericht auswählen",autofocus:"",class:"mb-3"},{item:l(({item:a,props:P})=>[t(re,Ae(Ke(P)),{default:l(()=>[t(Ie,null,{default:l(()=>[s(v(a.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"]),t(xe,null,{default:l(()=>[t(te,{cols:"6"},{default:l(()=>[t(q,{modelValue:z.value.scalingFactor,"onUpdate:modelValue":e[49]||(e[49]=a=>z.value.scalingFactor=a),label:"Skalierungsfaktor",type:"text",inputmode:"decimal",hint:"z.B. 0.5 für halbe Menge, 2 für doppelte Menge","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(te,{cols:"6",class:"d-flex align-center"},{default:l(()=>[t(ze,{modelValue:z.value.optional,"onUpdate:modelValue":e[50]||(e[50]=a=>z.value.optional=a),label:"Optional","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[51]||(e[51]=a=>M.value=!1)},{default:l(()=>[...e[92]||(e[92]=[s(" Abbrechen ",-1)])]),_:1}),t(f,{color:"primary",onClick:qe},{default:l(()=>[s(v(R.value?"Speichern":"Hinzufügen"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:ee.value,"onUpdate:modelValue":e[57]||(e[57]=a=>ee.value=a),"max-width":"800",scrollable:""},{default:l(()=>[t(J,{onKeydown:[e[56]||(e[56]=H(a=>ee.value=!1,["esc"])),H(pe(Qe,["ctrl"]),["enter"])]},{default:l(()=>[t(de,null,{default:l(()=>[...e[93]||(e[93]=[s("Gericht aus JSON importieren",-1)])]),_:1}),t(W,null,{default:l(()=>[t(Ce,{type:"info",variant:"tonal",class:"mb-4"},{default:l(()=>[...e[94]||(e[94]=[c("div",{class:"text-subtitle-2 mb-2"},"Erwartetes Format:",-1),c("pre",{class:"text-caption"},`{
  "name": "Gericht Name",
  "recipeUrl": "https://...",
  "defaultServings": 2,
  "ingredients": [
    {
      "productName": "Zutat 1",
      "amount": 200,
      "unit": "g",
      "optional": false
    }
  ]
}`,-1)])]),_:1}),t(tt,{modelValue:ie.value,"onUpdate:modelValue":e[54]||(e[54]=a=>ie.value=a),label:"JSON eingeben",rows:"15","auto-grow":"",class:"json-input"},null,8,["modelValue"]),Z.value?(u(),x(Ce,{key:0,type:"error",variant:"tonal",class:"mt-3"},{default:l(()=>[s(v(Z.value),1)]),_:1})):Q("",!0)]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[55]||(e[55]=a=>ee.value=!1)},{default:l(()=>[...e[95]||(e[95]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Qe,disabled:!ie.value.trim()},{default:l(()=>[...e[96]||(e[96]=[s(" Importieren ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["onKeydown"])]),_:1},8,["modelValue"]),t(Et,{modelValue:F.value,"onUpdate:modelValue":e[58]||(e[58]=a=>F.value=a)},null,8,["modelValue"]),t(Wt,{modelValue:$.value,"onUpdate:modelValue":e[59]||(e[59]=a=>$.value=a)},null,8,["modelValue"])])}}},Dl=Ee(Cl,[["__scopeId","data-v-18b8bed7"]]);export{Dl as default};
