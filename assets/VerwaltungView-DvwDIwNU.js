import{y as je,D as ct,p as $e,i as w,c as A,a as x,o as d,e as t,h as l,r,d as H,k as s,b as c,t as p,B as Te,C as Re,F as Q,m as We,f as te,g as C,x as vt,j as He,s as pt,E as ft,w as pe,z as gt}from"./index-DRwmrRCs.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";const bt={class:"mb-4"},_t={key:0},ht={class:"text-body-2"},kt={class:"text-caption text-medium-emphasis"},yt={key:1,class:"text-medium-emphasis"},wt={class:"text-center pa-4"},Vt={class:"text-medium-emphasis"},xt={key:0,class:"floating-action-bar-container"},Ct={class:"d-flex align-center justify-space-between pa-3"},St={class:"d-flex align-center gap-2"},Ut={__name:"ProductBulkEditor",props:{modelValue:Boolean},emits:["update:modelValue"],setup(ye,{emit:j}){const k=je(),P=ct(),g=$e(),L=j,N=w(""),D=w([]),I=w(!1),$=w({categoryId:null,unit:null,expirationDays:null}),ie=A(()=>{const m=[];m.push({value:null,title:"Keine Kategorie",subtitle:"-"});for(const o of P.vendors){const h=P.getCategoriesForVendor(o.id);for(const v of h)m.push({value:v.id,title:v.name,subtitle:o.name,vendorColor:o.color})}return m}),oe=[{title:"Name",key:"name",sortable:!0},{title:"Kategorie",key:"category",sortable:!1},{title:"Einheit",key:"defaultUnit",sortable:!0},{title:"Haltbarkeit (Tage)",key:"freshnessDays",sortable:!0}],T=["Stück","g","kg","ml","l","Packung","Bund","Dose","Glas"],Y=A(()=>{let m=k.products;if(N.value){const o=N.value.toLowerCase();m=m.filter(h=>h.name.toLowerCase().includes(o)||h.categoryName?.toLowerCase().includes(o)||h.vendorName?.toLowerCase().includes(o))}return[...m].sort((o,h)=>o.name.localeCompare(h.name))}),z=A(()=>D.value.length);function le(){if(z.value===0){g.showSnackbar("Bitte wählen Sie mindestens ein Produkt aus","warning");return}$.value={categoryId:null,unit:null,expirationDays:null},I.value=!0}async function ae(){try{const m={};if($.value.categoryId!==null&&$.value.categoryId!==""&&(m.categoryId=$.value.categoryId),$.value.unit!==null&&$.value.unit!==""&&(m.defaultUnit=$.value.unit),$.value.expirationDays!==null&&$.value.expirationDays!==""&&(m.freshnessDays=parseInt($.value.expirationDays)),Object.keys(m).length===0){g.showSnackbar("Bitte wählen Sie mindestens eine Eigenschaft zum Ändern","warning");return}console.log("Applying bulk updates:",m),console.log("To products:",D.value);const o=[];for(const E of D.value)try{const G=await k.updateProduct(E,m);o.push({productId:E,success:!0,result:G})}catch(G){console.error(`Failed to update product ${E}:`,G),o.push({productId:E,success:!1,error:G})}const h=o.filter(E=>E.success).length,v=o.filter(E=>!E.success).length;console.log("Update results:",{successCount:h,failCount:v,results:o}),v>0?g.showSnackbar(`${h} Produkte aktualisiert, ${v} Fehler`,"warning"):g.showSnackbar(`${h} Produkte aktualisiert`),I.value=!1,D.value=[],await k.fetchProducts()}catch(m){console.error("Bulk update error:",m),g.showSnackbar("Fehler beim Aktualisieren der Produkte","error")}}function Z(m){const o=D.value.indexOf(m);o===-1?D.value.push(m):D.value.splice(o,1)}function S(){D.value=[]}function u(){L("update:modelValue",!1)}return(m,o)=>{const h=r("v-btn"),v=r("v-toolbar-title"),E=r("v-toolbar"),G=r("v-text-field"),O=r("v-data-table"),V=r("v-card-text"),R=r("v-chip"),X=r("v-icon"),B=r("v-card"),W=r("v-dialog"),re=r("v-card-title"),fe=r("v-avatar"),U=r("v-list-item-subtitle"),ne=r("v-list-item"),ge=r("v-select"),Ve=r("v-spacer"),be=r("v-card-actions");return d(),x(Q,null,[t(W,{"model-value":ye.modelValue,"onUpdate:modelValue":o[3]||(o[3]=_=>L("update:modelValue",_)),fullscreen:"",transition:"dialog-bottom-transition"},{default:l(()=>[t(B,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(E,{color:"primary"},{default:l(()=>[t(h,{icon:"mdi-close",onClick:u}),t(v,null,{default:l(()=>[...o[9]||(o[9]=[s("Produkte bearbeiten",-1)])]),_:1})]),_:1}),t(V,{class:"pa-4 flex-grow-1 overflow-y-auto"},{default:l(()=>[c("div",bt,[t(G,{modelValue:N.value,"onUpdate:modelValue":o[0]||(o[0]=_=>N.value=_),"prepend-inner-icon":"mdi-magnify",label:"Produkte durchsuchen...","hide-details":"",clearable:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t(O,{modelValue:D.value,"onUpdate:modelValue":o[1]||(o[1]=_=>D.value=_),headers:oe,items:Y.value,"item-value":"id","show-select":"","items-per-page":-1,class:"elevation-1","select-strategy":"all","onClick:row":o[2]||(o[2]=(_,{item:_e})=>Z(_e.id))},{"item.category":l(({item:_})=>[_.categoryName?(d(),x("div",_t,[c("div",ht,p(_.categoryName),1),c("div",kt,p(_.vendorName||"—"),1)])):(d(),x("span",yt,"—"))]),"item.defaultUnit":l(({item:_})=>[s(p(_.defaultUnit||"—"),1)]),"item.freshnessDays":l(({item:_})=>[s(p(_.freshnessDays??"—"),1)]),bottom:l(()=>[c("div",wt,[c("span",Vt,p(Y.value.length)+" Produkte ",1)])]),_:1},8,["modelValue","items"])]),_:1}),z.value>0?(d(),x("div",xt,[t(B,{class:"floating-action-bar",elevation:"8"},{default:l(()=>[c("div",Ct,[c("div",St,[t(R,{color:"primary",variant:"flat",size:"small"},{default:l(()=>[s(p(z.value),1)]),_:1}),o[11]||(o[11]=c("span",{class:"text-body-2"},"ausgewählt",-1)),t(h,{variant:"text",size:"small",onClick:S},{default:l(()=>[...o[10]||(o[10]=[s(" Auswahl aufheben ",-1)])]),_:1})]),t(h,{color:"primary",size:"small",onClick:le},{default:l(()=>[t(X,{start:"",icon:"mdi-pencil"}),o[12]||(o[12]=s(" Bearbeiten ",-1))]),_:1})])]),_:1})])):H("",!0)]),_:1})]),_:1},8,["model-value"]),t(W,{modelValue:I.value,"onUpdate:modelValue":o[8]||(o[8]=_=>I.value=_),"max-width":"500"},{default:l(()=>[t(B,null,{default:l(()=>[t(re,null,{default:l(()=>[s(p(z.value)+" Produkte bearbeiten",1)]),_:1}),t(V,null,{default:l(()=>[o[13]||(o[13]=c("p",{class:"text-medium-emphasis mb-4"}," Wählen Sie die Eigenschaften aus, die Sie für alle ausgewählten Produkte ändern möchten. Nicht ausgefüllte Felder bleiben unverändert. ",-1)),t(ge,{modelValue:$.value.categoryId,"onUpdate:modelValue":o[4]||(o[4]=_=>$.value.categoryId=_),items:ie.value,"item-title":"title","item-value":"value",label:"Kategorie",clearable:"",class:"mb-3"},{item:l(({item:_,props:_e})=>[t(ne,Te(Re(_e)),{prepend:l(()=>[t(fe,{color:_.raw.vendorColor||"#9CA3AF",size:"24",class:"mr-2"},{default:l(()=>[t(X,{icon:"mdi-store",size:"small",color:"white"})]),_:1},8,["color"])]),default:l(()=>[t(U,null,{default:l(()=>[s(p(_.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),selection:l(({item:_})=>[t(R,{color:_.raw.vendorColor||"#9CA3AF",size:"small",label:""},{default:l(()=>[s(p(_.raw.title)+" ("+p(_.raw.subtitle)+") ",1)]),_:2},1032,["color"])]),_:1},8,["modelValue","items"]),t(ge,{modelValue:$.value.unit,"onUpdate:modelValue":o[5]||(o[5]=_=>$.value.unit=_),items:T,label:"Einheit",clearable:"",class:"mb-3"},null,8,["modelValue"]),t(G,{modelValue:$.value.expirationDays,"onUpdate:modelValue":o[6]||(o[6]=_=>$.value.expirationDays=_),modelModifiers:{number:!0},label:"Haltbarkeit (Tage)",type:"number",inputmode:"numeric",min:"0",clearable:"",hint:"Anzahl der Tage, die das Produkt nach dem Kauf haltbar ist","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(be,null,{default:l(()=>[t(Ve),t(h,{variant:"text",onClick:o[7]||(o[7]=_=>I.value=!1)},{default:l(()=>[...o[14]||(o[14]=[s(" Abbrechen ",-1)])]),_:1}),t(h,{color:"primary",onClick:ae},{default:l(()=>[...o[15]||(o[15]=[s(" Änderungen übernehmen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Nt=De(Ut,[["__scopeId","data-v-b76b33ee"]]),$t={class:"mb-4"},Dt={key:0,class:"d-flex flex-wrap gap-1"},It={key:1,class:"text-medium-emphasis"},Pt={class:"text-center pa-4"},zt={class:"text-medium-emphasis"},Ft={key:0,class:"floating-action-bar-container"},At={class:"d-flex align-center justify-space-between pa-3"},Lt={class:"d-flex align-center gap-2"},Bt={__name:"DishBulkEditor",props:{modelValue:Boolean},emits:["update:modelValue"],setup(ye,{emit:j}){const k=We(),P=$e(),g=j,L=w(""),N=w([]),D=w(!1),I=w({categories:[],published:null}),$=["Dels","Reis","Leisch","Getarisch","Toffels","Rühtück","Suppe","Lat","Holschompf"],ie=[{title:"Name",key:"name",sortable:!0},{title:"Kategorien",key:"categories",sortable:!1},{title:"Portionen",key:"defaultServings",sortable:!0}],oe=A(()=>{let S=k.dishes.filter(u=>u.type!=="eating_out");if(L.value){const u=L.value.toLowerCase();S=S.filter(m=>m.name.toLowerCase().includes(u)||m.categories?.some(o=>o.toLowerCase().includes(u)))}return[...S].sort((u,m)=>u.name.localeCompare(m.name))}),T=A(()=>N.value.length);function Y(){if(T.value===0){P.showSnackbar("Bitte wählen Sie mindestens ein Gericht aus","warning");return}I.value={categories:[],published:null},D.value=!0}async function z(){try{const S={};if(I.value.categories&&I.value.categories.length>0&&(S.categories=I.value.categories),I.value.published!==null&&(S.published=I.value.published),Object.keys(S).length===0){P.showSnackbar("Bitte wählen Sie mindestens ein Feld zum Aktualisieren","warning");return}console.log("Applying bulk updates:",S),console.log("To dishes:",N.value);const u=[];for(const h of N.value)try{const v=await k.updateDish(h,S);u.push({dishId:h,success:!0,result:v})}catch(v){console.error(`Failed to update dish ${h}:`,v),u.push({dishId:h,success:!1,error:v})}const m=u.filter(h=>h.success).length,o=u.filter(h=>!h.success).length;console.log("Update results:",{successCount:m,failCount:o,results:u}),o>0?P.showSnackbar(`${m} Gerichte aktualisiert, ${o} Fehler`,"warning"):P.showSnackbar(`${m} Gerichte aktualisiert`),D.value=!1,N.value=[],await k.fetchDishes()}catch(S){console.error("Bulk update error:",S),P.showSnackbar("Fehler beim Aktualisieren der Gerichte","error")}}function le(S){const u=N.value.indexOf(S);u===-1?N.value.push(S):N.value.splice(u,1)}function ae(){N.value=[]}function Z(){g("update:modelValue",!1)}return(S,u)=>{const m=r("v-btn"),o=r("v-toolbar-title"),h=r("v-toolbar"),v=r("v-text-field"),E=r("v-chip"),G=r("v-data-table"),O=r("v-card-text"),V=r("v-icon"),R=r("v-card"),X=r("v-dialog"),B=r("v-card-title"),W=r("v-select"),re=r("v-spacer"),fe=r("v-card-actions");return d(),x(Q,null,[t(X,{"model-value":ye.modelValue,"onUpdate:modelValue":u[3]||(u[3]=U=>g("update:modelValue",U)),fullscreen:"",transition:"dialog-bottom-transition"},{default:l(()=>[t(R,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(h,{color:"primary"},{default:l(()=>[t(m,{icon:"mdi-close",onClick:Z}),t(o,null,{default:l(()=>[...u[8]||(u[8]=[s("Gerichte bearbeiten",-1)])]),_:1})]),_:1}),t(O,{class:"pa-4 flex-grow-1 overflow-y-auto"},{default:l(()=>[c("div",$t,[t(v,{modelValue:L.value,"onUpdate:modelValue":u[0]||(u[0]=U=>L.value=U),"prepend-inner-icon":"mdi-magnify",label:"Gerichte durchsuchen...","hide-details":"",clearable:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t(G,{modelValue:N.value,"onUpdate:modelValue":u[1]||(u[1]=U=>N.value=U),headers:ie,items:oe.value,"item-value":"id","show-select":"","items-per-page":-1,class:"elevation-1","select-strategy":"all","onClick:row":u[2]||(u[2]=(U,{item:ne})=>le(ne.id))},{"item.categories":l(({item:U})=>[U.categories&&U.categories.length>0?(d(),x("div",Dt,[(d(!0),x(Q,null,te(U.categories,ne=>(d(),C(E,{key:ne,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[s(p(ne),1)]),_:2},1024))),128))])):(d(),x("span",It,"—"))]),"item.defaultServings":l(({item:U})=>[s(p(U.defaultServings||"—"),1)]),bottom:l(()=>[c("div",Pt,[c("span",zt,p(oe.value.length)+" Gerichte ",1)])]),_:1},8,["modelValue","items"])]),_:1}),T.value>0?(d(),x("div",Ft,[t(R,{class:"floating-action-bar",elevation:"8"},{default:l(()=>[c("div",At,[c("div",Lt,[t(E,{color:"primary",variant:"flat",size:"small"},{default:l(()=>[s(p(T.value),1)]),_:1}),u[10]||(u[10]=c("span",{class:"text-body-2"},"ausgewählt",-1)),t(m,{variant:"text",size:"small",onClick:ae},{default:l(()=>[...u[9]||(u[9]=[s(" Auswahl aufheben ",-1)])]),_:1})]),t(m,{color:"primary",size:"small",onClick:Y},{default:l(()=>[t(V,{start:"",icon:"mdi-pencil"}),u[11]||(u[11]=s(" Bearbeiten ",-1))]),_:1})])]),_:1})])):H("",!0)]),_:1})]),_:1},8,["model-value"]),t(X,{modelValue:D.value,"onUpdate:modelValue":u[7]||(u[7]=U=>D.value=U),"max-width":"500"},{default:l(()=>[t(R,null,{default:l(()=>[t(B,null,{default:l(()=>[s(p(T.value)+" Gerichte bearbeiten",1)]),_:1}),t(O,null,{default:l(()=>[u[12]||(u[12]=c("p",{class:"text-medium-emphasis mb-4"}," Wählen Sie die Felder aus, die für alle ausgewählten Gerichte aktualisiert werden sollen. ",-1)),t(W,{modelValue:I.value.categories,"onUpdate:modelValue":u[4]||(u[4]=U=>I.value.categories=U),items:$,label:"Kategorien",multiple:"",chips:"","closable-chips":"",hint:"Die ausgewählten Kategorien ersetzen die bestehenden Kategorien","persistent-hint":"",class:"mb-4"},null,8,["modelValue"]),t(W,{modelValue:I.value.published,"onUpdate:modelValue":u[5]||(u[5]=U=>I.value.published=U),items:[{title:"Nicht ändern",value:null},{title:"Im Planer anzeigen",value:!0},{title:"Aus Planer ausblenden",value:!1}],label:"Sichtbarkeit im Planer",hint:"Legt fest, ob die Gerichte im Planer zur Auswahl stehen","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(fe,null,{default:l(()=>[t(re),t(m,{variant:"text",onClick:u[6]||(u[6]=U=>D.value=!1)},{default:l(()=>[...u[13]||(u[13]=[s(" Abbrechen ",-1)])]),_:1}),t(m,{color:"primary",onClick:z},{default:l(()=>[...u[14]||(u[14]=[s(" Änderungen übernehmen ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Et=De(Bt,[["__scopeId","data-v-97166af6"]]),Gt={class:"verwaltung-view"},Kt={class:"d-flex justify-end mb-4 gap-2"},Zt={key:0},Ot={class:"vendor-header"},Ht={class:"d-flex align-center gap-2"},jt={class:"text-subtitle-1 font-weight-medium"},Tt={class:"d-flex align-center gap-1"},Rt={class:"d-flex align-center gap-1"},Wt={key:1,class:"text-center pa-4 mb-4"},Mt={class:"d-flex align-center justify-space-between mb-4 flex-wrap gap-2"},Jt={class:"d-flex gap-2"},qt={class:"d-flex flex-wrap align-center ga-2 mb-1"},Qt={class:"text-body-1"},Xt={class:"text-caption text-medium-emphasis"},Yt={class:"d-flex align-center justify-space-between mb-4 flex-wrap gap-2"},el={class:"d-flex gap-2"},tl={class:"d-flex flex-wrap align-center ga-2 mb-1"},ll={class:"text-body-1"},al={class:"text-caption text-medium-emphasis"},nl={class:"mb-4"},ol={class:"text-subtitle-2 mb-3"},il={class:"text-subtitle-1 font-weight-bold mb-2"},rl={key:0},sl={key:1,class:"text-medium-emphasis"},ul={class:"d-flex flex-wrap gap-2"},dl={class:"d-flex align-center justify-space-between mb-3"},ml={class:"text-subtitle-2"},cl={key:0},vl={key:1},pl={__name:"VerwaltungView",setup(ye){const j=je(),k=vt(),P=We(),g=$e(),L=w(""),N=w("vendors"),D=w(window.innerWidth),I=w(!1),$=w(!1);A(()=>D.value<960);const ie=A(()=>D.value>=640);function oe(){D.value=window.innerWidth}const T=w(!1),Y=w(null),z=w({name:"",color:"#10B981"}),le=w(!1),ae=w(null),Z=w({name:"",vendorId:null}),S=w(!1),u=w(null),m=w({name:"",categoryId:null,defaultUnit:"",freshnessDays:7}),o=w(!1),h=w(null),v=w({name:"",recipe:"",recipeUrl:"",defaultServings:2,categories:[],ingredients:[],published:!1}),E=["Dels","Reis","Leisch","Getarisch","Toffels","Rühtück","Suppe","Lat","Holschompf"],G=w(!1),O=w(null),V=w({productId:null,productName:"",amount:1,unit:"",optional:!1}),R=w(!1),X=w(""),B=w(""),W=w(""),re=["g","kg","ml","l","Stück","EL","TL","Bund","Packung","Dose","Paar"],fe=["#10B981","#0EA5E9","#8B5CF6","#F97316","#EF4444","#EC4899","#14B8A6","#6366F1"],U=A(()=>[...k.vendors].sort((n,e)=>n.name.localeCompare(e.name))),ne=A(()=>{let n=j.products;if(L.value&&N.value==="products"){const e=L.value.toLowerCase();n=n.filter(i=>i.name.toLowerCase().includes(e))}return[...n].sort((e,i)=>e.name.localeCompare(i.name))}),ge=A(()=>{let n=P.dishes;if(L.value&&N.value==="dishes"){const e=L.value.toLowerCase();n=n.filter(i=>i.name.toLowerCase().includes(e))}return[...n].sort((e,i)=>e.name.localeCompare(i.name))}),Ve=A(()=>k.categories.map(n=>{const e=k.vendors.find(i=>i.id===n.vendorId);return{...n,vendorName:e?.name||"Unbekannt",vendorColor:e?.color||"#9CA3AF",displayName:`${n.name} (${e?.name||"Unbekannt"})`}}).sort((n,e)=>n.name.localeCompare(e.name))),be=A(()=>[...k.vendors].sort((e,i)=>e.name.localeCompare(i.name)).map(e=>{const i=k.getCategoriesForVendor(e.id).sort((b,y)=>(b.order||0)-(y.order||0));return{...e,categories:i}})),_=A(()=>{if(!W.value||W.value.length<2)return[];const n=W.value.toLowerCase(),e=[];for(const i of P.dishes)if(i.type!=="eating_out"&&i.ingredients&&Array.isArray(i.ingredients))for(const b of i.ingredients)(b.productName||"").toLowerCase().includes(n)&&e.push({dishId:i.id,dishName:i.name,ingredientName:b.productName,ingredientAmount:b.amount,ingredientUnit:b.unit,ingredientOptional:b.optional||!1});return e}),_e=A(()=>{const n=new Set;return _.value.forEach(e=>n.add(e.dishId)),Array.from(n)}),Me=A(()=>{const n=new Map;for(const e of _.value){const i=e.ingredientName;n.has(i)||n.set(i,{ingredientName:i,dishes:[]}),n.get(i).dishes.push({id:e.dishId,name:e.dishName,ingredientAmount:e.ingredientAmount,ingredientUnit:e.ingredientUnit,ingredientOptional:e.ingredientOptional})}return Array.from(n.values()).sort((e,i)=>e.ingredientName.localeCompare(i.ingredientName))}),Ie=A(()=>ne.value.map(n=>{const e=k.categories.find(b=>b.id===n.categoryId),i=e?k.vendors.find(b=>b.id===e.vendorId):null;return{...n,categoryName:e?.name||null,vendorName:i?.name||null,vendorColor:i?.color||"#9CA3AF"}})),Je=A(()=>j.products.map(n=>{const e=k.categories.find(b=>b.id===n.categoryId),i=e?k.vendors.find(b=>b.id===e.vendorId):null;return{value:n.id,title:n.name,subtitle:i&&e?`${i.name}: ${e.name}`:"Keine Kategorie",product:n}}));He(()=>V.value.productId,n=>{if(!n)return;const e=j.products.find(i=>i.id===n);e&&(V.value.productName=e.name,e.defaultUnit&&!V.value.unit&&(V.value.unit=e.defaultUnit))}),He(()=>V.value.productName,n=>{if(!n||V.value.productId)return;const e=n.toLowerCase().trim(),i=j.products.find(b=>b.name.toLowerCase()===e);i&&(V.value.productId=i.id)});function Pe(n=null){n?(Y.value=n,z.value={...n}):(Y.value=null,z.value={name:"",color:"#10B981"}),T.value=!0}async function qe(){if(!z.value.name.trim()){g.showSnackbar("Name ist erforderlich","error");return}try{Y.value?(await k.updateVendor(Y.value.id,z.value),g.showSnackbar("Händler aktualisiert")):(await k.createVendor(z.value),g.showSnackbar("Händler erstellt")),T.value=!1}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function Qe(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await k.deleteVendor(n.id),g.showSnackbar("Händler gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}function ze(n=null){n?(ae.value=n,Z.value={...n}):(ae.value=null,Z.value={name:"",vendorId:null}),le.value=!0}async function Xe(){if(!Z.value.name.trim()||!Z.value.vendorId){g.showSnackbar("Name und Händler sind erforderlich","error");return}try{ae.value?(await k.updateCategory(ae.value.id,Z.value),g.showSnackbar("Kategorie aktualisiert")):(await k.createCategory(Z.value),g.showSnackbar("Kategorie erstellt")),le.value=!1}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function Ye(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await k.deleteCategory(n.id),g.showSnackbar("Kategorie gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}async function et(n,e){const i=k.getCategoriesForVendor(e).sort((f,se)=>(f.order||0)-(se.order||0)),b=i.findIndex(f=>f.id===n.id);if(b<=0)return;const y=i[b-1];try{await k.updateCategory(n.id,{order:y.order}),await k.updateCategory(y.id,{order:n.order}),await k.fetchCategories(),g.showSnackbar("Reihenfolge aktualisiert")}catch{g.showSnackbar("Fehler beim Verschieben","error")}}async function tt(n,e){const i=k.getCategoriesForVendor(e).sort((f,se)=>(f.order||0)-(se.order||0)),b=i.findIndex(f=>f.id===n.id);if(b>=i.length-1)return;const y=i[b+1];try{await k.updateCategory(n.id,{order:y.order}),await k.updateCategory(y.id,{order:n.order}),await k.fetchCategories(),g.showSnackbar("Reihenfolge aktualisiert")}catch{g.showSnackbar("Fehler beim Verschieben","error")}}function Fe(n=null){n?(u.value=n,m.value={...n}):(u.value=null,m.value={name:"",categoryId:null,defaultUnit:"",freshnessDays:7}),S.value=!0}async function lt(){if(!m.value.name.trim()){g.showSnackbar("Name ist erforderlich","error");return}try{u.value?(await j.updateProduct(u.value.id,m.value),g.showSnackbar("Produkt aktualisiert")):(await j.createProduct(m.value),g.showSnackbar("Produkt erstellt")),S.value=!1}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function at(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await j.deleteProduct(n.id),g.showSnackbar("Produkt gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}function xe(n=null){n?(h.value=n,v.value={name:n.name,recipe:n.recipe||"",recipeUrl:n.recipeUrl||"",defaultServings:n.defaultServings,categories:[...n.categories||[]],ingredients:[...n.ingredients||[]],published:n.published??!0}):(h.value=null,v.value={name:"",recipe:"",recipeUrl:"",defaultServings:2,categories:[],ingredients:[],published:!1}),o.value=!0}async function nt(){if(!v.value.name.trim()){g.showSnackbar("Name ist erforderlich","error");return}try{const n={name:v.value.name.trim(),recipe:v.value.recipe||null,recipeUrl:v.value.recipeUrl||null,defaultServings:v.value.defaultServings,categories:v.value.categories,ingredients:v.value.ingredients,published:v.value.published,type:"dish"};h.value?(await P.updateDish(h.value.id,n),g.showSnackbar("Gericht aktualisiert")):(await P.createDish(n),g.showSnackbar("Gericht erstellt")),o.value=!1,await P.fetchDishes()}catch{g.showSnackbar("Fehler beim Speichern","error")}}async function ot(n){if(confirm(`"${n.name}" wirklich löschen?`))try{await P.deleteDish(n.id),g.showSnackbar("Gericht gelöscht")}catch{g.showSnackbar("Fehler beim Löschen","error")}}function Ae(n=null){n?(O.value=n,V.value={...n}):(O.value=null,V.value={productId:null,productName:"",amount:1,unit:"",optional:!1}),G.value=!0}function it(){if(!V.value.productName.trim()){g.showSnackbar("Name ist erforderlich","error");return}let n=parseFloat(V.value.amount),e=V.value.unit;(!n||n===0)&&!e&&(n=null,e=null);const i={id:O.value?.id||crypto.randomUUID(),productId:V.value.productId||null,productName:V.value.productName.trim(),amount:n,unit:e,optional:V.value.optional};if(O.value){const b=v.value.ingredients.findIndex(y=>y.id===O.value.id);b!==-1&&(v.value.ingredients[b]=i)}else v.value.ingredients.push(i);G.value=!1}function rt(n){v.value.ingredients=v.value.ingredients.filter(e=>e.id!==n.id)}function st(){X.value="",B.value="",R.value=!0}async function ut(){B.value="";try{const n=JSON.parse(X.value);if(!n.name||typeof n.name!="string"){B.value='Fehler: "name" ist erforderlich und muss ein String sein';return}if(!Array.isArray(n.ingredients)){B.value='Fehler: "ingredients" muss ein Array sein';return}for(let i=0;i<n.ingredients.length;i++){const b=n.ingredients[i];if(!b.productName||typeof b.productName!="string"){B.value=`Fehler in Zutat ${i+1}: "productName" ist erforderlich`;return}if(b.amount!==null&&b.amount!==void 0&&typeof b.amount!="number"){B.value=`Fehler in Zutat ${i+1}: "amount" muss eine Zahl oder null sein`;return}}const e={name:n.name,recipeUrl:n.recipeUrl||null,defaultServings:n.defaultServings||2,categories:n.categories||[],ingredients:n.ingredients.map(i=>{let b=i.amount??null,y=i.unit??null;return(b===null||b===0)&&(y===null||y==="")&&(b=null,y=null),{id:crypto.randomUUID(),productId:null,productName:i.productName,amount:b,unit:y,optional:i.optional||!1}}),type:"dish"};await P.createDish(e),g.showSnackbar("Gericht aus JSON erstellt"),R.value=!1,await P.fetchDishes()}catch(n){n instanceof SyntaxError?B.value=`JSON Syntax-Fehler: ${n.message}`:B.value=`Fehler: ${n.message}`}}return pt(()=>{window.addEventListener("resize",oe),j.fetchProducts(),k.fetchVendors(),k.fetchCategories(),P.fetchDishes()}),ft(()=>{window.removeEventListener("resize",oe)}),(n,e)=>{const i=r("v-tab"),b=r("v-tabs"),y=r("v-icon"),f=r("v-btn"),se=r("v-avatar"),Le=r("v-list-item-title"),ue=r("v-list-item"),he=r("v-list"),Be=r("v-divider"),M=r("v-card-text"),J=r("v-card"),we=r("v-window-item"),q=r("v-text-field"),Ee=r("v-chip"),Ge=r("v-list-item-subtitle"),dt=r("v-window"),de=r("v-card-title"),me=r("v-spacer"),ce=r("v-card-actions"),ve=r("v-dialog"),Ce=r("v-select"),Ke=r("v-combobox"),ee=r("v-col"),Se=r("v-row"),Ze=r("v-textarea"),Oe=r("v-checkbox"),Ue=r("v-alert"),mt=r("v-autocomplete");return d(),x("div",Gt,[e[81]||(e[81]=c("h1",{class:"text-h5 font-weight-bold mb-4"},"Verwaltung",-1)),t(b,{modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=a=>N.value=a),color:"primary",class:"mb-4"},{default:l(()=>[t(i,{value:"vendors"},{default:l(()=>[...e[47]||(e[47]=[s("Kategorien",-1)])]),_:1}),t(i,{value:"products"},{default:l(()=>[...e[48]||(e[48]=[s("Produkte",-1)])]),_:1}),t(i,{value:"dishes"},{default:l(()=>[...e[49]||(e[49]=[s("Gerichte",-1)])]),_:1}),t(i,{value:"ingredients"},{default:l(()=>[...e[50]||(e[50]=[s("Zutaten",-1)])]),_:1})]),_:1},8,["modelValue"]),t(dt,{modelValue:N.value,"onUpdate:modelValue":e[12]||(e[12]=a=>N.value=a)},{default:l(()=>[t(we,{value:"vendors"},{default:l(()=>[c("div",Kt,[t(f,{variant:"tonal",color:"primary",onClick:e[1]||(e[1]=a=>ze())},{default:l(()=>[t(y,{start:"",icon:"mdi-plus"}),e[51]||(e[51]=s(" Neue Kategorie ",-1))]),_:1}),t(f,{color:"primary",onClick:e[2]||(e[2]=a=>Pe())},{default:l(()=>[t(y,{start:"",icon:"mdi-plus"}),e[52]||(e[52]=s(" Neuer Händler ",-1))]),_:1})]),t(J,{variant:"flat",color:"surface"},{default:l(()=>[be.value.length>0?(d(),x("div",Zt,[(d(!0),x(Q,null,te(be.value,(a,K)=>(d(),x("div",{key:a.id},[c("div",Ot,[c("div",Ht,[t(se,{color:a.color,size:"24"},{default:l(()=>[t(y,{icon:"mdi-store",size:"small",color:"white"})]),_:1},8,["color"]),c("span",jt,p(a.name),1)]),c("div",Tt,[t(f,{icon:"mdi-pencil",variant:"text",size:"x-small",onClick:F=>Pe(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:F=>Qe(a)},null,8,["onClick"])])]),a.categories.length>0?(d(),C(he,{key:0,density:"compact",class:"mb-4"},{default:l(()=>[(d(!0),x(Q,null,te(a.categories,(F,Ne)=>(d(),C(ue,{key:F.id,onClick:ke=>ze(F),class:"category-item"},{prepend:l(()=>[t(y,{icon:"mdi-tag",size:"small",color:"primary",class:"ml-4"})]),append:l(()=>[c("div",Rt,[t(f,{icon:"mdi-arrow-up",variant:"text",size:"x-small",disabled:Ne===0,onClick:pe(ke=>et(F,a.id),["stop"])},null,8,["disabled","onClick"]),t(f,{icon:"mdi-arrow-down",variant:"text",size:"x-small",disabled:Ne===a.categories.length-1,onClick:pe(ke=>tt(F,a.id),["stop"])},null,8,["disabled","onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:pe(ke=>Ye(F),["stop"])},null,8,["onClick"])])]),default:l(()=>[t(Le,null,{default:l(()=>[s(p(F.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)):(d(),x("div",Wt,[...e[53]||(e[53]=[c("span",{class:"text-caption text-medium-emphasis"},"Keine Kategorien",-1)])])),K<be.value.length-1?(d(),C(Be,{key:2,class:"my-2"})):H("",!0)]))),128))])):(d(),C(M,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[54]||(e[54]=[c("div",{class:"text-medium-emphasis"},"Keine Händler vorhanden",-1)])]),_:1}))]),_:1})]),_:1}),t(we,{value:"products"},{default:l(()=>[c("div",Mt,[t(q,{modelValue:L.value,"onUpdate:modelValue":e[3]||(e[3]=a=>L.value=a),"prepend-inner-icon":"mdi-magnify",label:"Produkte suchen...",clearable:"","hide-details":"",style:{"max-width":"300px"}},null,8,["modelValue"]),c("div",Jt,[ie.value?(d(),C(f,{key:0,variant:"tonal",color:"primary",onClick:e[4]||(e[4]=a=>I.value=!0)},{default:l(()=>[t(y,{start:"",icon:"mdi-table-edit"}),e[55]||(e[55]=s(" Massenbearbeitung ",-1))]),_:1})):H("",!0),t(f,{color:"primary",onClick:e[5]||(e[5]=a=>Fe())},{default:l(()=>[t(y,{start:"",icon:"mdi-plus"}),e[56]||(e[56]=s(" Neues Produkt ",-1))]),_:1})])]),t(J,{variant:"flat",color:"surface"},{default:l(()=>[Ie.value.length>0?(d(),C(he,{key:0,density:"compact"},{default:l(()=>[(d(!0),x(Q,null,te(Ie.value,a=>(d(),C(ue,{key:a.id,onClick:K=>Fe(a)},{default:l(()=>[c("div",qt,[c("span",Qt,p(a.name),1),a.categoryName?(d(),C(Ee,{key:0,color:a.vendorColor,size:"x-small",label:""},{default:l(()=>[s(p(a.vendorName)+": "+p(a.categoryName),1)]),_:2},1032,["color"])):H("",!0)]),c("div",Xt,p(a.defaultUnit||"Keine Einheit")+" · "+p(a.freshnessDays)+" Tage haltbar ",1)]),append:l(()=>[t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:pe(K=>at(a),["stop"])},null,8,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1})):(d(),C(M,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[57]||(e[57]=[c("div",{class:"text-medium-emphasis"},"Keine Produkte gefunden",-1)])]),_:1}))]),_:1})]),_:1}),t(we,{value:"dishes"},{default:l(()=>[c("div",Yt,[t(q,{modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=a=>L.value=a),"prepend-inner-icon":"mdi-magnify",label:"Gerichte suchen...",clearable:"","hide-details":"",style:{"max-width":"300px"}},null,8,["modelValue"]),c("div",el,[ie.value?(d(),C(f,{key:0,variant:"tonal",color:"primary",onClick:e[7]||(e[7]=a=>$.value=!0)},{default:l(()=>[t(y,{start:"",icon:"mdi-table-edit"}),e[58]||(e[58]=s(" Massenbearbeitung ",-1))]),_:1})):H("",!0),t(f,{variant:"tonal",color:"primary",onClick:e[8]||(e[8]=a=>st())},{default:l(()=>[t(y,{start:"",icon:"mdi-code-json"}),e[59]||(e[59]=s(" JSON Import ",-1))]),_:1}),t(f,{color:"primary",onClick:e[9]||(e[9]=a=>xe())},{default:l(()=>[t(y,{start:"",icon:"mdi-plus"}),e[60]||(e[60]=s(" Neues Gericht ",-1))]),_:1})])]),t(J,{variant:"flat",color:"surface"},{default:l(()=>[ge.value.length>0?(d(),C(he,{key:0},{default:l(()=>[(d(!0),x(Q,null,te(ge.value,a=>(d(),C(ue,{key:a.id,onClick:K=>xe(a)},{prepend:l(()=>[t(se,{color:"primary",variant:"tonal"},{default:l(()=>[t(y,{icon:a.type==="eating_out"?"mdi-food-takeout-box":"mdi-food"},null,8,["icon"])]),_:2},1024)]),default:l(()=>[c("div",tl,[c("span",ll,p(a.name),1),(d(!0),x(Q,null,te(a.categories,K=>(d(),C(Ee,{key:K,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[s(p(K),1)]),_:2},1024))),128))]),c("div",al,p(a.defaultServings)+" Portionen · "+p(a.ingredients?.length||0)+" Zutaten ",1)]),append:l(()=>[a.recipe?(d(),C(y,{key:0,icon:"mdi-book-open-variant",size:"small",class:"mr-2 text-medium-emphasis"})):H("",!0),a.recipeUrl?(d(),C(f,{key:1,icon:"mdi-open-in-new",variant:"text",size:"small",href:a.recipeUrl,target:"_blank",onClick:e[10]||(e[10]=pe(()=>{},["stop"]))},null,8,["href"])):H("",!0),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:pe(K=>ot(a),["stop"])},null,8,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1})):(d(),C(M,{key:1,class:"text-center pa-8"},{default:l(()=>[...e[61]||(e[61]=[c("div",{class:"text-medium-emphasis"},"Keine Gerichte gefunden",-1)])]),_:1}))]),_:1})]),_:1}),t(we,{value:"ingredients"},{default:l(()=>[c("div",nl,[t(q,{modelValue:W.value,"onUpdate:modelValue":e[11]||(e[11]=a=>W.value=a),"prepend-inner-icon":"mdi-magnify",label:"Zutat suchen...",clearable:"","hide-details":"",style:{"max-width":"400px"}},null,8,["modelValue"])]),_.value.length>0?(d(),C(J,{key:0,variant:"flat",color:"surface"},{default:l(()=>[t(M,null,{default:l(()=>[c("div",ol,p(_.value.length)+" Zutat(en) gefunden in "+p(_e.value.length)+" Gericht(en) ",1),(d(!0),x(Q,null,te(Me.value,(a,K)=>(d(),x("div",{key:K,class:"mb-6"},[c("div",il,p(a.ingredientName),1),t(he,{density:"compact"},{default:l(()=>[(d(!0),x(Q,null,te(a.dishes,F=>(d(),C(ue,{key:F.id,onClick:Ne=>xe(gt(P).dishes.find(ke=>ke.id===F.id))},{prepend:l(()=>[t(y,{icon:"mdi-food",color:"primary"})]),default:l(()=>[t(Le,null,{default:l(()=>[s(p(F.name),1)]),_:2},1024),t(Ge,null,{default:l(()=>[F.ingredientAmount!==null&&F.ingredientAmount!==0?(d(),x("span",rl,p(F.ingredientAmount)+" "+p(F.ingredientUnit),1)):H("",!0),F.ingredientOptional?(d(),x("span",sl," (optional)")):H("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]))),128))]),_:1})]),_:1})):W.value?(d(),C(J,{key:1,variant:"flat",color:"surface"},{default:l(()=>[t(M,{class:"text-center pa-8"},{default:l(()=>[...e[62]||(e[62]=[c("div",{class:"text-medium-emphasis"}," Keine Gerichte mit dieser Zutat gefunden ",-1)])]),_:1})]),_:1})):(d(),C(J,{key:2,variant:"flat",color:"surface"},{default:l(()=>[t(M,{class:"text-center pa-8"},{default:l(()=>[t(y,{icon:"mdi-information-outline",size:"48",class:"mb-3 text-medium-emphasis"}),e[63]||(e[63]=c("div",{class:"text-medium-emphasis"}," Geben Sie eine Zutat ein, um alle Gerichte zu finden, die diese Zutat verwenden ",-1))]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:T.value,"onUpdate:modelValue":e[15]||(e[15]=a=>T.value=a),"max-width":"400"},{default:l(()=>[t(J,null,{default:l(()=>[t(de,null,{default:l(()=>[s(p(Y.value?"Händler bearbeiten":"Neuer Händler"),1)]),_:1}),t(M,null,{default:l(()=>[t(q,{modelValue:z.value.name,"onUpdate:modelValue":e[13]||(e[13]=a=>z.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),e[64]||(e[64]=c("div",{class:"text-subtitle-2 mb-2"},"Farbe",-1)),c("div",ul,[(d(),x(Q,null,te(fe,a=>t(f,{key:a,color:a,variant:z.value.color===a?"flat":"outlined",icon:"",size:"small",onClick:K=>z.value.color=a},{default:l(()=>[z.value.color===a?(d(),C(y,{key:0,icon:"mdi-check",color:"white"})):H("",!0)]),_:2},1032,["color","variant","onClick"])),64))])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[14]||(e[14]=a=>T.value=!1)},{default:l(()=>[...e[65]||(e[65]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:qe},{default:l(()=>[...e[66]||(e[66]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:le.value,"onUpdate:modelValue":e[19]||(e[19]=a=>le.value=a),"max-width":"400"},{default:l(()=>[t(J,null,{default:l(()=>[t(de,null,{default:l(()=>[s(p(ae.value?"Kategorie bearbeiten":"Neue Kategorie"),1)]),_:1}),t(M,null,{default:l(()=>[t(q,{modelValue:Z.value.name,"onUpdate:modelValue":e[16]||(e[16]=a=>Z.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),t(Ce,{modelValue:Z.value.vendorId,"onUpdate:modelValue":e[17]||(e[17]=a=>Z.value.vendorId=a),items:U.value,"item-title":"name","item-value":"id",label:"Händler"},null,8,["modelValue","items"])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[18]||(e[18]=a=>le.value=!1)},{default:l(()=>[...e[67]||(e[67]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:Xe},{default:l(()=>[...e[68]||(e[68]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:S.value,"onUpdate:modelValue":e[25]||(e[25]=a=>S.value=a),"max-width":"500"},{default:l(()=>[t(J,null,{default:l(()=>[t(de,null,{default:l(()=>[s(p(u.value?"Produkt bearbeiten":"Neues Produkt"),1)]),_:1}),t(M,null,{default:l(()=>[t(q,{modelValue:m.value.name,"onUpdate:modelValue":e[20]||(e[20]=a=>m.value.name=a),label:"Name",autofocus:"",class:"mb-3"},null,8,["modelValue"]),t(Ce,{modelValue:m.value.categoryId,"onUpdate:modelValue":e[21]||(e[21]=a=>m.value.categoryId=a),items:Ve.value,"item-title":"displayName","item-value":"id",label:"Kategorie",clearable:"",class:"mb-3"},null,8,["modelValue","items"]),t(Se,null,{default:l(()=>[t(ee,{cols:"6"},{default:l(()=>[t(Ke,{modelValue:m.value.defaultUnit,"onUpdate:modelValue":e[22]||(e[22]=a=>m.value.defaultUnit=a),items:re,label:"Standard-Einheit"},null,8,["modelValue"])]),_:1}),t(ee,{cols:"6"},{default:l(()=>[t(q,{modelValue:m.value.freshnessDays,"onUpdate:modelValue":e[23]||(e[23]=a=>m.value.freshnessDays=a),modelModifiers:{number:!0},label:"Haltbarkeit (Tage)",type:"number",inputmode:"numeric",min:"1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[24]||(e[24]=a=>S.value=!1)},{default:l(()=>[...e[69]||(e[69]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:lt},{default:l(()=>[...e[70]||(e[70]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:o.value,"onUpdate:modelValue":e[34]||(e[34]=a=>o.value=a),"max-width":"700",scrollable:""},{default:l(()=>[t(J,null,{default:l(()=>[t(de,null,{default:l(()=>[s(p(h.value?"Gericht bearbeiten":"Neues Gericht"),1)]),_:1}),t(M,null,{default:l(()=>[e[73]||(e[73]=c("div",{class:"text-subtitle-2 mb-3"},"Grunddaten",-1)),t(Se,null,{default:l(()=>[t(ee,{cols:"12",md:"6"},{default:l(()=>[t(q,{modelValue:v.value.name,"onUpdate:modelValue":e[26]||(e[26]=a=>v.value.name=a),label:"Name",autofocus:""},null,8,["modelValue"])]),_:1}),t(ee,{cols:"12",md:"6"},{default:l(()=>[t(q,{modelValue:v.value.recipeUrl,"onUpdate:modelValue":e[27]||(e[27]=a=>v.value.recipeUrl=a),label:"Rezept-Link",type:"url","prepend-inner-icon":"mdi-link"},null,8,["modelValue"])]),_:1}),t(ee,{cols:"12",md:"4"},{default:l(()=>[t(q,{modelValue:v.value.defaultServings,"onUpdate:modelValue":e[28]||(e[28]=a=>v.value.defaultServings=a),modelModifiers:{number:!0},label:"Standard-Portionen",type:"number",inputmode:"numeric",min:"1",max:"20"},null,8,["modelValue"])]),_:1}),t(ee,{cols:"12"},{default:l(()=>[t(Ce,{modelValue:v.value.categories,"onUpdate:modelValue":e[29]||(e[29]=a=>v.value.categories=a),items:E,label:"Kategorien",multiple:"",chips:"","closable-chips":"",hint:"Wähle eine oder mehrere Kategorien für dieses Gericht","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(ee,{cols:"12"},{default:l(()=>[t(Ze,{modelValue:v.value.recipe,"onUpdate:modelValue":e[30]||(e[30]=a=>v.value.recipe=a),label:"Rezept / Zubereitungsanleitung",hint:"Hier kannst du die Zubereitung Schritt für Schritt beschreiben","persistent-hint":"",rows:"6","auto-grow":"","prepend-inner-icon":"mdi-book-open-variant"},null,8,["modelValue"])]),_:1}),t(ee,{cols:"12"},{default:l(()=>[t(Oe,{modelValue:v.value.published,"onUpdate:modelValue":e[31]||(e[31]=a=>v.value.published=a),label:"Im Planer anzeigen",hint:"Wenn deaktiviert, wird das Gericht nicht im Planer zur Auswahl angezeigt","persistent-hint":"",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1}),t(Be,{class:"my-4"}),c("div",dl,[c("div",ml," Zutaten ("+p(v.value.ingredients.length)+") — pro Portion ",1),t(f,{variant:"tonal",color:"primary",size:"small",onClick:e[32]||(e[32]=a=>Ae())},{default:l(()=>[t(y,{start:"",icon:"mdi-plus"}),e[71]||(e[71]=s(" Zutat hinzufügen ",-1))]),_:1})]),v.value.ingredients.length>0?(d(),C(he,{key:0,density:"compact"},{default:l(()=>[(d(!0),x(Q,null,te(v.value.ingredients,a=>(d(),C(ue,{key:a.id,title:a.productName},{subtitle:l(()=>[a.amount!==null&&a.amount!==0&&a.unit!==null?(d(),x("span",cl,p(a.amount)+" "+p(a.unit)+p(a.optional?" (optional)":""),1)):a.optional?(d(),x("span",vl,"(optional)")):H("",!0)]),prepend:l(()=>[t(y,{icon:"mdi-circle-small"})]),append:l(()=>[t(f,{icon:"mdi-pencil",variant:"text",size:"small",onClick:K=>Ae(a)},null,8,["onClick"]),t(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:K=>rt(a)},null,8,["onClick"])]),_:2},1032,["title"]))),128))]),_:1})):(d(),C(Ue,{key:1,type:"info",variant:"tonal",class:"mt-2"},{default:l(()=>[...e[72]||(e[72]=[s(" Noch keine Zutaten hinzugefügt ",-1)])]),_:1}))]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[33]||(e[33]=a=>o.value=!1)},{default:l(()=>[...e[74]||(e[74]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:nt},{default:l(()=>[...e[75]||(e[75]=[s("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:G.value,"onUpdate:modelValue":e[41]||(e[41]=a=>G.value=a),"max-width":"500"},{default:l(()=>[t(J,null,{default:l(()=>[t(de,null,{default:l(()=>[s(p(O.value?"Zutat bearbeiten":"Zutat hinzufügen"),1)]),_:1}),t(M,null,{default:l(()=>[t(mt,{modelValue:V.value.productId,"onUpdate:modelValue":e[35]||(e[35]=a=>V.value.productId=a),items:Je.value,"item-title":"title","item-value":"value",label:"Produkt auswählen (optional)",clearable:"",class:"mb-3"},{item:l(({item:a,props:K})=>[t(ue,Te(Re(K)),{default:l(()=>[t(Ge,null,{default:l(()=>[s(p(a.raw.subtitle),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"]),t(q,{modelValue:V.value.productName,"onUpdate:modelValue":e[36]||(e[36]=a=>V.value.productName=a),label:"Produktname",autofocus:!O.value,class:"mb-3",hint:"Wird automatisch ausgefüllt, wenn ein Produkt ausgewählt wurde"},null,8,["modelValue","autofocus"]),t(Se,null,{default:l(()=>[t(ee,{cols:"6"},{default:l(()=>[t(q,{modelValue:V.value.amount,"onUpdate:modelValue":e[37]||(e[37]=a=>V.value.amount=a),modelModifiers:{number:!0},label:"Menge pro Portion",type:"number",inputmode:"decimal",min:"0",step:"0.1"},null,8,["modelValue"])]),_:1}),t(ee,{cols:"6"},{default:l(()=>[t(Ke,{modelValue:V.value.unit,"onUpdate:modelValue":e[38]||(e[38]=a=>V.value.unit=a),items:re,label:"Einheit"},null,8,["modelValue"])]),_:1})]),_:1}),t(Oe,{modelValue:V.value.optional,"onUpdate:modelValue":e[39]||(e[39]=a=>V.value.optional=a),label:"Optional","hide-details":""},null,8,["modelValue"])]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[40]||(e[40]=a=>G.value=!1)},{default:l(()=>[...e[76]||(e[76]=[s(" Abbrechen ",-1)])]),_:1}),t(f,{color:"primary",onClick:it},{default:l(()=>[s(p(O.value?"Speichern":"Hinzufügen"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:R.value,"onUpdate:modelValue":e[44]||(e[44]=a=>R.value=a),"max-width":"800",scrollable:""},{default:l(()=>[t(J,null,{default:l(()=>[t(de,null,{default:l(()=>[...e[77]||(e[77]=[s("Gericht aus JSON importieren",-1)])]),_:1}),t(M,null,{default:l(()=>[t(Ue,{type:"info",variant:"tonal",class:"mb-4"},{default:l(()=>[...e[78]||(e[78]=[c("div",{class:"text-subtitle-2 mb-2"},"Erwartetes Format:",-1),c("pre",{class:"text-caption"},`{
  "name": "Gericht Name",
  "recipeUrl": "https://...",
  "defaultServings": 2,
  "ingredients": [
    {
      "productName": "Zutat 1",
      "amount": 200,
      "unit": "g",
      "optional": false
    }
  ]
}`,-1)])]),_:1}),t(Ze,{modelValue:X.value,"onUpdate:modelValue":e[42]||(e[42]=a=>X.value=a),label:"JSON eingeben",rows:"15","auto-grow":"",class:"json-input"},null,8,["modelValue"]),B.value?(d(),C(Ue,{key:0,type:"error",variant:"tonal",class:"mt-3"},{default:l(()=>[s(p(B.value),1)]),_:1})):H("",!0)]),_:1}),t(ce,null,{default:l(()=>[t(me),t(f,{variant:"text",onClick:e[43]||(e[43]=a=>R.value=!1)},{default:l(()=>[...e[79]||(e[79]=[s("Abbrechen",-1)])]),_:1}),t(f,{color:"primary",onClick:ut,disabled:!X.value.trim()},{default:l(()=>[...e[80]||(e[80]=[s(" Importieren ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Nt,{modelValue:I.value,"onUpdate:modelValue":e[45]||(e[45]=a=>I.value=a)},null,8,["modelValue"]),t(Et,{modelValue:$.value,"onUpdate:modelValue":e[46]||(e[46]=a=>$.value=a)},null,8,["modelValue"])])}}},bl=De(pl,[["__scopeId","data-v-47b9e89f"]]);export{bl as default};
